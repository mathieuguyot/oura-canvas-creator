(this["webpackJsonpoura-canvas-creator"]=this["webpackJsonpoura-canvas-creator"]||[]).push([[0],{104:function(t,e,n){},217:function(t,e,n){"use strict";n.r(e);var o,a,i=n(0),r=n.n(i),c=n(17),s=n.n(c),u=(n(104),n(3)),l=n(10),d=n(11),p=n(42),v=n.n(p),h=n(16),f=n(12),m=n.n(f);function y(t,e){return t.x===e.x&&t.y===e.y}function b(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}!function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT"}(o||(o={})),function(t){t[t.NO_PINS=0]="NO_PINS",t[t.LEFT_PIN=1]="LEFT_PIN",t[t.RIGHT_PIN=2]="RIGHT_PIN",t[t.BOTH_PINS=3]="BOTH_PINS"}(a||(a={}));var g=n(62),P=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),O=function(t){function e(e){var n=t.call(this,e)||this;return n.panStartPosition=null,n.shiftKey=!1,n.state={panDisabled:!1},n.onMouseDown=n.onMouseDown.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n.onZoomChange=n.onZoomChange.bind(n),n.onPanning=n.onPanning.bind(n),n.onPanningStart=n.onPanningStart.bind(n),n.onPanningStop=n.onPanningStop.bind(n),n}return P(e,t),e.prototype.onMouseDown=function(t){this.shiftKey=t.shiftKey;var e=t.target,n=!1;"string"===typeof e.id&&(n="link_canvas"===e.id);var o=!1;"string"===typeof e.className&&(o=e.className.includes("react-transform-component")),this.setState({panDisabled:0!==t.button||!n&&!o})},e.prototype.onMouseUp=function(){this.setState({panDisabled:!1})},e.prototype.onZoomChange=function(t){(0,this.props.onPanZoomInfo)({zoom:t.scale,topLeftCorner:{x:t.positionX,y:t.positionY}})},e.prototype.onPanning=function(t){(0,this.props.onPanZoomInfo)({zoom:t.scale,topLeftCorner:{x:t.positionX,y:t.positionY}})},e.prototype.onPanningStart=function(t){this.panStartPosition={x:t.positionX,y:t.positionY}},e.prototype.onPanningStop=function(t){var e=this.props.onSelectItem,n={x:t.positionX,y:t.positionY};m.a.isEqual(this.panStartPosition,n)&&e(null,this.shiftKey)},e.prototype.render=function(){var t=this.props,e=t.panZoomInfo,n=t.children,o=this.state.panDisabled;return i.createElement("div",{id:"panzoom",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},i.createElement(g.b,{options:{disabled:o,limitToBounds:!1,minScale:.35,centerContent:!1},pan:{velocity:!1},doubleClick:{disabled:!0},wheel:{step:100},onWheel:this.onZoomChange,onPanningStart:this.onPanningStart,onPanning:this.onPanning,onPanningStop:this.onPanningStop,scale:e.zoom,positionX:e.topLeftCorner.x,positionY:e.topLeftCorner.y,defaultScale:e.zoom,defaultPositionX:e.topLeftCorner.x,defaultPositionY:e.topLeftCorner.y},i.createElement(g.a,null,i.createElement("div",{style:{height:"100vh",width:"100vw"}},n))))},e}(i.Component);var x={theme:{node:{selected:{boxShadow:"0px 0px 0px 2px white",borderRadius:"10px 10px 10px 10px"},header:{backgroundColor:"orange",color:"white",borderRadius:"10px 10px 0px 0px",height:"20px",cursor:"grab",overflow:"hidden",paddingLeft:"10px"},body:{color:"white",backgroundColor:"rgba(63, 63, 63, 0.75)",cursor:"grab"},footer:{borderRadius:"0px 0px 10px 10px",height:"10px",backgroundColor:"rgba(63, 63, 63, 0.75)",cursor:"ew-resize"},basePin:{backgroundColor:"rgba(199, 199, 41, 1)",borderRadius:"5px 5px 5px 5px",cursor:"grab"},customPins:{string:{backgroundColor:"red",transform:"rotate(45deg)"}}},link:{selected:{stroke:"white",strokeWidth:"3px",fill:"none"},unselected:{stroke:"rgba(170, 170, 170, 0.75)",strokeWidth:"3px",fill:"none"}},connectors:{leftText:{width:"40%",textOverflow:"ellipsis",overflow:"hidden"},string:{width:"100%",backgroundColor:"#585858",color:"white",border:0,outline:"none"},number:{width:"60%",boxSizing:"border-box",backgroundColor:"#585858",color:"white",border:0,outline:"none",textAlign:"right",borderRadius:"8px",paddingRight:"5px"},select:{width:"60%",backgroundColor:"#585858",boxSizing:"border-box",color:"white",border:0,outline:"none",textAlign:"right",borderRadius:"8px",paddingRight:"5px"},button:{width:"100%",backgroundColor:"#585858",color:"white",border:0,outline:"none"}}},buildBackgroundStyle:function(t){var e=String(200*t.zoom);return{backgroundColor:"#232323",backgroundPosition:"".concat(t.topLeftCorner.x,"px ").concat(t.topLeftCorner.y,"px"),backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='".concat(e,"' height='").concat(e,"' viewBox='0 0 100 100'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='black' fill-opacity='0.4'%3E%3Cpath opacity='.5' d='M96 95h4v1h-4v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9zm-1 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9z'/%3E%3Cpath d='M6 5V0H5v5H0v1h5v94h1V6h94V5H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")")}}},k=Object(i.createContext)(x),C=function(){return C=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},C.apply(this,arguments)};function j(t){var e=Object(i.useContext)(k).buildBackgroundStyle,n=t.panZoomInfo,o=t.children,a={position:"relative",top:"0",left:"0",width:"100%",height:"100%",overflow:"hidden"};return e&&(a=C(C({},a),e(n))),r.a.createElement("div",{style:a},o)}var w=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),E=function(){return E=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},E.apply(this,arguments)},_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return w(e,t),e.prototype.shouldComponentUpdate=function(t){return!f.isEqual(this.props,t)},e.prototype.onSelectLink=function(t){var e=this.props,n=e.linkId,o=e.onSelectLink;o&&n&&o(n,t.shiftKey)},e.prototype.render=function(){var t,e,n,o,a,i,c=this.context.theme,s=this.props,u=s.linkId,l=s.linkPosition,d=s.isLinkSelected,p=l.inputPinPosition.x,v=l.inputPinPosition.y,h=l.outputPinPosition.x,f=l.outputPinPosition.y,m=function(t,e){var n=Math.abs(e.x-t.x)/2,o=e.x<t.x?e.x+n:e.x-n,a=Math.abs(e.y-t.y)/2;return{x:o,y:e.y<t.y?e.y+a:e.y-a}}(l.inputPinPosition,l.outputPinPosition),y="M".concat(p,",").concat(v," C").concat(m.x,",").concat(v," ").concat(m.x,",").concat(f," ").concat(h,",").concat(f),b=d?E(E({},null===(t=null===c||void 0===c?void 0:c.link)||void 0===t?void 0:t.selected),null===(n=null===(e=this.props.link)||void 0===e?void 0:e.theme)||void 0===n?void 0:n.selected):E(E({},null===(o=null===c||void 0===c?void 0:c.link)||void 0===o?void 0:o.unselected),null===(i=null===(a=this.props.link)||void 0===a?void 0:a.theme)||void 0===i?void 0:i.unselected);return r.a.createElement("path",{id:"link_".concat(u),d:y,style:b,onClick:this.onSelectLink.bind(this)})},e}(i.Component),I=_;_.contextType=k;var N=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),L=function(){return L=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},L.apply(this,arguments)},T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return N(e,t),e.prototype.shouldComponentUpdate=function(t){return!f.isEqual(this.props,t)},e.prototype.onSelectLink=function(t){var e=this.props,n=e.linkId,o=e.onSelectLink;o&&n&&o(n,t.shiftKey)},e.prototype.render=function(){var t,e,n,o,a,i,c=this.context.theme,s=this.props,u=s.linkId,l=s.linkPosition,d=s.isLinkSelected?L(L({},null===(t=null===c||void 0===c?void 0:c.link)||void 0===t?void 0:t.selected),null===(n=null===(e=this.props.link)||void 0===e?void 0:e.theme)||void 0===n?void 0:n.selected):L(L({},null===(o=null===c||void 0===c?void 0:c.link)||void 0===o?void 0:o.unselected),null===(i=null===(a=this.props.link)||void 0===a?void 0:a.theme)||void 0===i?void 0:i.unselected);return r.a.createElement("line",{id:"link_".concat(u),x1:l.inputPinPosition.x,y1:l.inputPinPosition.y,x2:l.outputPinPosition.x,y2:l.outputPinPosition.y,style:d,onClick:this.onSelectLink.bind(this)})},e}(i.Component),S=T;T.contextType=k;var M=function(){return M=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},M.apply(this,arguments)};function F(t){var e=t.link;return"line"===(null===e||void 0===e?void 0:e.linkType)?r.a.createElement(S,M({},t)):r.a.createElement(I,M({},t))}function z(t){var e=t.links,n=t.linksPositions,o=t.selectedItems,a=t.draggedLink,i=t.onSelectItem;return r.a.createElement("svg",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",overflow:"visible"},id:"link_canvas"},Object.keys(e).filter((function(t){return t in n})).map((function(t){return F({linkId:t,link:e[t],key:t,linkPosition:n[t],isLinkSelected:m.a.some(o,{id:t,type:"link"}),onSelectLink:function(t,e){return i({id:t,type:"link"},e)}})})),a&&F({linkPosition:a,isLinkSelected:!1}))}var R=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return R(e,t),e.prototype.shouldComponentUpdate=function(t){return!f.isEqual(this.props,t)},e.prototype.render=function(){var t=this.props.connector;return r.a.createElement("div",{className:"node-background",style:{textAlign:t.pinLayout===a.RIGHT_PIN?"right":"left"}},t.name)},e}(i.Component),J=U,H=function(t){var e=t.message;return r.a.createElement("div",{style:{color:"red"}},"error: ".concat(e))},D=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Z=function(){return Z=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},Z.apply(this,arguments)},A=function(t){function e(e){var n=t.call(this,e)||this;return n.textAreaRef=r.a.createRef(),n.onChange=n.onChange.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n}return D(e,t),e.prototype.shouldComponentUpdate=function(t){return!m.a.isEqual(this.props,t)},e.prototype.onChange=function(t){var e=this.props,n=e.nodeId,o=e.cId,a=e.connector;(0,e.onConnectorUpdate)(n,o,Object(h.a)(a,(function(e){e.data.value=t.currentTarget.value})))},e.prototype.onMouseUp=function(){if(this.textAreaRef.current){var t=this.props,e=t.nodeId,n=t.cId,o=t.connector,a=t.onConnectorUpdate,i=this.textAreaRef.current.style.height;a(e,n,Object(h.a)(o,(function(t){t.data.height=i})))}},e.prototype.render=function(){var t,e=this.context.theme,n=this.props.connector;if(!("value"in n.data)){return r.a.createElement(H,{message:"'string' connector types must provide a string field named 'value'"})}var o="height"in n.data?n.data.height:100;return r.a.createElement("textarea",{ref:this.textAreaRef,style:Z({height:o,whiteSpace:"pre",resize:"vertical"},null===(t=null===e||void 0===e?void 0:e.connectors)||void 0===t?void 0:t.string),value:n.data.value,onChange:this.onChange,onMouseUp:this.onMouseUp,placeholder:n.name})},e}(i.Component),G=A;A.contextType=k;var B=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),W=function(t){function e(e){var n=t.call(this,e)||this;return n.onChange=n.onChange.bind(n),n}return B(e,t),e.prototype.onChange=function(){var t=this.props,e=t.nodeId,n=t.cId,o=t.connector;(0,t.onConnectorUpdate)(e,n,Object(h.a)(o,(function(t){t.data.value=!t.data.value})))},e.prototype.render=function(){var t=this.props.connector;if(!("value"in t.data)){return r.a.createElement(H,{message:"'check_box' connector types must provide a bool field named 'value'"})}return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{tabIndex:-1,checked:t.data.value,onChange:this.onChange,type:"checkbox",style:{backgroundColor:"#585858",color:"white",border:0,outline:"none"}}),t.name)},e}(i.Component),V=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),q=function(t){function e(e){var n=t.call(this,e)||this;return n.onChange=n.onChange.bind(n),n}return V(e,t),e.prototype.shouldComponentUpdate=function(t){return!m.a.isEqual(this.props,t)},e.prototype.onChange=function(t){var e=this.props,n=e.nodeId,o=e.cId,a=e.connector,i=e.onConnectorUpdate;isNaN(Number(t.currentTarget.value))||i(n,o,Object(h.a)(a,(function(e){e.data.value=t.currentTarget.value})))},e.prototype.render=function(){var t,e,n=this.context.theme,o=this.props.connector;if(!("value"in o.data)){return r.a.createElement(H,{message:"'number' connector types must provide a string field named 'value'"})}return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{className:"node-background",style:null===(t=null===n||void 0===n?void 0:n.connectors)||void 0===t?void 0:t.leftText},o.name),r.a.createElement("input",{disabled:"disabled"in o.data&&o.data.disabled,style:null===(e=null===n||void 0===n?void 0:n.connectors)||void 0===e?void 0:e.number,value:o.data.value,onChange:this.onChange,placeholder:o.name}))},e}(i.Component),X=q;q.contextType=k;var Y=function(t){var e,n,o=t.connector,a=t.nodeId,c=t.cId,s=t.onConnectorUpdate,u=Object(i.useContext)(k).theme;if(!("values"in o.data)||!("selected_index"in o.data)){return r.a.createElement(H,{message:"'select' connector types must provide a string array field named 'values' and a number field 'selected_index'"})}var l=Object(i.useCallback)((function(t){var e=Object(h.a)(o,(function(e){e.data.selected_index=t}));s(a,c,e)}),[s,a,c,o]);return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{className:"node-background",style:null===(e=null===u||void 0===u?void 0:u.connectors)||void 0===e?void 0:e.leftText},o.name),r.a.createElement("select",{onChange:function(t){return l(t.target.selectedIndex)},style:null===(n=null===u||void 0===u?void 0:u.connectors)||void 0===n?void 0:n.select,defaultValue:o.data.values[o.data.selected_index]},o.data.values.map((function(t){return r.a.createElement("option",{key:t,value:t},t)}))))},K=function(t){var e,n=t.connector,o=t.node,a=Object(i.useContext)(k).theme;if(!("label"in n.data)||!("onClick"in n.data)){return r.a.createElement(H,{message:"'button' connector types must provide a string field named 'label' and a callback 'onClick'"})}return r.a.createElement("button",{style:null===(e=null===a||void 0===a?void 0:a.connectors)||void 0===e?void 0:e.button,onClick:function(){return n.data.onClick(o)}},n.data.label)},Q=function(){return Q=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},Q.apply(this,arguments)};var $=function(){return $=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},$.apply(this,arguments)},tt=function(){function t(){this.onMouseMoveCb=function(){return null},this.onMouseUpCb=function(){return null},this.initialPos={x:0,y:0},this.finalPos={x:0,y:0},this.tmpPos={x:0,y:0},this.getZoom=function(){return 1},this.targetClassName="",this.lastZoom=0,this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this)}return t.prototype.onMouseDown=function(t,e,n,o,a){window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp),this.getZoom=n,this.initialPos=e,this.finalPos={x:e.x,y:e.y};var i=n();this.lastZoom=i,this.tmpPos={x:t.pageX/i,y:t.pageY/i},this.onMouseMoveCb=o,this.onMouseUpCb=a},t.prototype.onMouseMove=function(t){var e=this.getZoom(),n={x:t.pageX/this.lastZoom-this.tmpPos.x,y:t.pageY/this.lastZoom-this.tmpPos.y};this.finalPos.x+=n.x,this.finalPos.y+=n.y,this.tmpPos={x:t.pageX/e,y:t.pageY/e};var o=t.target.className;"string"===typeof o&&(this.targetClassName=o),this.onMouseMoveCb($({},this.initialPos),$({},this.finalPos),n,this.targetClassName),this.lastZoom=e},t.prototype.onMouseUp=function(t){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),this.onMouseUpCb($({},this.initialPos),$({},this.finalPos),t)},t}(),et=function(){return et=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},et.apply(this,arguments)},nt=function(t){var e,n,o,a,c=t.className,s=t.contentType,u=t.leftPinPosition,l=t.pinPxRadius,d=t.pinColor,p=t.onMouseDown,v=Object(i.useContext)(k).theme,h=void 0;(null===(e=null===v||void 0===v?void 0:v.node)||void 0===e?void 0:e.customPins)&&(null===(n=null===v||void 0===v?void 0:v.node)||void 0===n?void 0:n.customPins[s])&&(h=null===(o=null===v||void 0===v?void 0:v.node)||void 0===o?void 0:o.customPins[s]);var f=et(et({position:"absolute",width:"".concat(2*l,"px"),height:"".concat(2*l,"px"),left:"".concat(u,"px"),top:"calc(50% - ".concat(l,"px)")},null===(a=null===v||void 0===v?void 0:v.node)||void 0===a?void 0:a.basePin),h);return d&&(f.backgroundColor=d),r.a.createElement("div",{className:c,style:f,onMouseDown:p})},ot=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),at=function(t){function e(e){var n=t.call(this,e)||this;return n.dragWrapper=new tt,n.connectorRef=r.a.createRef(),n.leftPinPos=null,n.rightPinPos=null,n.pinPxRadius=6,n.onMouseDown=n.onMouseDown.bind(n),n.onPinPositionUpdate=n.onPinPositionUpdate.bind(n),n}return ot(e,t),e.prototype.componentDidMount=function(){this.onPinPositionUpdate()},e.prototype.componentDidUpdate=function(){this.onPinPositionUpdate()},e.prototype.onPinPositionUpdate=function(){var t=this.props,e=t.cId,n=t.onPinPositionUpdate,a=this.getConnectorPinPosition(o.LEFT),i=this.getConnectorPinPosition(o.RIGHT);m.a.isEqual(a,this.leftPinPos)&&m.a.isEqual(i,this.rightPinPos)||(this.leftPinPos=a,this.leftPinPos=i,n(e,a,i))},e.prototype.onMouseDown=function(t,e){var n=this.props,a=n.nodeId,i=n.cId,r=n.getZoom,c=n.onUpdatePreviewLink,s=n.onCreateLink,u=this.getConnectorPinPosition(t);if(u&&c&&s){this.dragWrapper.onMouseDown(e,u,r,(function(t,e){c({linkId:"preview",outputPinPosition:e,inputPinPosition:t})}),(function(e,n,r){var u=null;r.target&&("string"===typeof r.target.className&&(u=r.target.className.match(/node-(.+)-connector-(.+)-(left|right)/)));null!==u&&s({inputNodeId:a,inputPinId:i,inputPinSide:t===o.LEFT?o.LEFT:o.RIGHT,outputNodeId:u[1],outputPinId:u[2],outputPinSide:"left"===u[3]?o.LEFT:o.RIGHT,linkType:"bezier"}),c(void 0)}))}},e.prototype.getConnectorPinPosition=function(t){var e=this.props,n=e.connector,i=e.node,r=this.connectorRef.current;return!r||n.pinLayout===a.NO_PINS||t===o.LEFT&&n.pinLayout===a.RIGHT_PIN||t===o.RIGHT&&n.pinLayout===a.LEFT_PIN?null:{x:t===o.RIGHT?i.width+i.position.x:i.position.x,y:i.position.y+r.offsetTop+r.offsetHeight/2}},e.prototype.render=function(){var t=this,e=this.props,n=e.connector,i=e.node,c=e.nodeId,s=e.cId,u=e.createCustomConnectorComponent,l=null;return u&&(l=u(this.props)),l||(l=function(t){var e=t.connector;return"string"===e.contentType?r.a.createElement(G,Q({},t)):"number"===e.contentType?r.a.createElement(X,Q({},t)):"check_box"===e.contentType?r.a.createElement(W,Q({},t)):"select"===e.contentType?r.a.createElement(Y,Q({},t)):"button"===e.contentType?r.a.createElement(K,Q({},t)):r.a.createElement(J,Q({},t))}(this.props)),r.a.createElement("div",{className:"node-background",ref:this.connectorRef,style:{position:"relative",paddingTop:3}},[a.LEFT_PIN,a.BOTH_PINS].includes(n.pinLayout)&&r.a.createElement(nt,{className:"node-".concat(c,"-connector-").concat(s,"-left"),contentType:n.contentType,pinPxRadius:this.pinPxRadius,leftPinPosition:-this.pinPxRadius,onMouseDown:function(e){return t.onMouseDown(o.LEFT,e)},pinColor:this.props.connector.leftPinColor}),[a.RIGHT_PIN,a.BOTH_PINS].includes(n.pinLayout)&&r.a.createElement(nt,{className:"node-".concat(c,"-connector-").concat(s,"-right"),contentType:n.contentType,pinPxRadius:this.pinPxRadius,leftPinPosition:i.width-this.pinPxRadius,onMouseDown:function(e){return t.onMouseDown(o.RIGHT,e)},pinColor:this.props.connector.rightPinColor}),r.a.createElement("div",{className:"node-background",style:{overflow:"hidden",paddingLeft:2*this.pinPxRadius,paddingRight:2*this.pinPxRadius}},l))},e}(i.Component),it=function(){return it=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},it.apply(this,arguments)};function rt(t){var e,n,o=t.node,a=Object(i.useContext)(k).theme;return r.a.createElement("div",{className:"node-background node-header",style:it(it({},null===(e=a.node)||void 0===e?void 0:e.header),null===(n=o.theme)||void 0===n?void 0:n.header)},o.name)}var ct=function(){return ct=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},ct.apply(this,arguments)};function st(t){var e,n,o=t.node,a=Object(i.useContext)(k).theme;return r.a.createElement("div",{className:"node-background node-footer",style:ct(ct({},null===(e=null===a||void 0===a?void 0:a.node)||void 0===e?void 0:e.footer),null===(n=null===o||void 0===o?void 0:o.theme)||void 0===n?void 0:n.footer)})}var ut=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),lt=function(){return lt=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},lt.apply(this,arguments)},dt=function(t){function e(e){var n=t.call(this,e)||this;return n.dragWrapper=new tt,n.pinPositions={},n.onMouseDown=n.onMouseDown.bind(n),n.onPinPositionUpdate=n.onPinPositionUpdate.bind(n),n}return ut(e,t),e.prototype.shouldComponentUpdate=function(t){var e=this.props,n=e.node;return e.isNodeSelected!==t.isNodeSelected||!m.a.isEqual(n,t.node)},e.prototype.onMouseDown=function(t){var e=this.props,n=e.nodeId,o=e.getZoom,a=e.onNodeMoveStart,i=e.onNodeMove,r=e.onNodeMoveEnd;if(a&&i&&r){var c=!0,s="";if(t.target){var u=t.target.className;"string"===typeof u&&u.includes("node-background")&&(s=u,c=!1)}if(!c){a(n,t.shiftKey);var l=o(),d={x:t.pageX/l,y:t.pageY/l};this.dragWrapper.onMouseDown(t,d,o,(function(t,e,n){s.includes("node-footer")?i(0,0,n.x):i(n.x,n.y,0)}),(function(t,e,o){r(n,!y(t,e),o.shiftKey)}))}}},e.prototype.onPinPositionUpdate=function(t,e,n){var o=this.props,i=o.nodeId,r=o.node,c=o.onNodePinPositionsUpdate;this.pinPositions[t]=[e,n];var s=Object.keys(r.connectors).filter((function(t){return r.connectors[t].pinLayout!==a.NO_PINS})).length;Object.keys(this.pinPositions).length===s&&c(i,this.pinPositions)},e.prototype.render=function(){var t,e,n,o,a,i,c=this,s=this.context.theme,u=this.props,l=u.nodeId,d=u.node,p=u.isNodeSelected,v=this.props,h=v.onCreateLink,f=v.onUpdatePreviewLink,m=v.getZoom,y=v.onConnectorUpdate,b=this.props.createCustomConnectorComponent,g={position:"absolute",width:"".concat(d.width,"px"),top:"".concat(d.position.y,"px"),left:"".concat(d.position.x,"px")},P=p?lt(lt({},null===(t=null===s||void 0===s?void 0:s.node)||void 0===t?void 0:t.selected),null===(e=null===d||void 0===d?void 0:d.theme)||void 0===e?void 0:e.selected):lt(lt({},null===(n=null===s||void 0===s?void 0:s.node)||void 0===n?void 0:n.unselected),null===(o=null===d||void 0===d?void 0:d.theme)||void 0===o?void 0:o.unselected);return r.a.createElement("div",{className:"node-background",style:lt(lt({},g),P),onMouseDown:this.onMouseDown,id:"node_".concat(l)},r.a.createElement(rt,{node:d}),r.a.createElement("div",{style:lt(lt({},null===(a=null===s||void 0===s?void 0:s.node)||void 0===a?void 0:a.body),null===(i=null===d||void 0===d?void 0:d.theme)||void 0===i?void 0:i.body)},Object.keys(d.connectors).map((function(t){return r.a.createElement(at,{nodeId:l,cId:t,getZoom:m,node:d,key:t,connector:d.connectors[t],onCreateLink:h,onUpdatePreviewLink:f,onConnectorUpdate:y,onPinPositionUpdate:c.onPinPositionUpdate,createCustomConnectorComponent:b})}))),r.a.createElement(st,{node:d}))},e}(i.Component);dt.contextType=k;var pt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),vt=function(t){function e(e){var n=t.call(this,e)||this;return n.onNodeMoveStart=n.onNodeMoveStart.bind(n),n.onNodeMove=n.onNodeMove.bind(n),n.onNodeMoveEnd=n.onNodeMoveEnd.bind(n),n}return pt(e,t),e.prototype.onNodeMoveStart=function(t,e){var n=this,o=this.props,a=o.selectedItems,i=o.onSelectItem,r={id:t,type:"node"},c=!1;a.forEach((function(t){t.id===r.id&&t.type===r.type&&(c=!0)})),c||(this.lastSettedSelection=r,a.forEach((function(e){e.id===t&&"node"===e.type&&(n.lastSettedSelection=void 0)})),e&&this.lastSettedSelection&&i(r,e),e||i(r,e))},e.prototype.onNodeMove=function(t,e,n){var o=this;this.props.selectedItems.forEach((function(a){if("node"===a.type){var i=o.props,r=i.nodes,c=i.onNodeMove,s=r[a.id].position.x+t,u=r[a.id].position.y+e,l=r[a.id].width+n;c(a.id,s,u,l>100?l:100)}}))},e.prototype.onNodeMoveEnd=function(t,e,n){var o=this.props.onSelectItem,a={id:t,type:"node"};(e||n)&&(e||!n||m.a.isEqual(a,this.lastSettedSelection))||o(a,n),this.lastSettedSelection=void 0},e.prototype.render=function(){var t=this,e=this.props,n=e.nodes,o=e.selectedItems,a=this.props,i=a.getZoom,c=a.onCreateLink,s=a.onUpdatePreviewLink,u=a.onNodePinPositionsUpdate,l=this.props,d=l.onConnectorUpdate,p=l.createCustomConnectorComponent;return r.a.createElement(r.a.Fragment,null,Object.keys(n).map((function(e){return r.a.createElement(dt,{nodeId:e,key:e,node:n[e],isNodeSelected:m.a.some(o,{id:e,type:"node"}),getZoom:i,onNodeMoveStart:t.onNodeMoveStart,onNodeMove:t.onNodeMove,onNodeMoveEnd:t.onNodeMoveEnd,onCreateLink:c,onUpdatePreviewLink:s,onNodePinPositionsUpdate:u,onConnectorUpdate:d,createCustomConnectorComponent:p})})))},e}(r.a.Component),ht=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ht(e,t),e.prototype.render=function(){var t={position:"absolute",width:"100px",height:"100px",top:"".concat(this.props.customElement.position.x,"px"),left:"".concat(this.props.customElement.position.y,"px"),backgroundColor:"orange"};return r.a.createElement("div",{style:t},"aaaaaa")},e}(i.Component),mt=ft,yt=function(){return yt=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},yt.apply(this,arguments)};function bt(t){var e=t.customElements,n=t.onSelectItem;return r.a.createElement(r.a.Fragment,null,Object.keys(e).map((function(o){var a={customElement:e[o],customElementId:o,onCustomElementUpdate:function(){},onSelectItem:n};return t.createCustomElement&&t.createCustomElement(a)||function(t){return"comment"===t.customElement.type?r.a.createElement(mt,yt({key:t.customElementId},t)):null}(a)})))}var gt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Pt=function(t,e,n){if(n||2===arguments.length)for(var o,a=0,i=e.length;a<i;a++)!o&&a in e||(o||(o=Array.prototype.slice.call(e,0,a)),o[a]=e[a]);return t.concat(o||Array.prototype.slice.call(e))};Object(h.b)();var Ot,xt=function(t){function e(e){var n=t.call(this,e)||this;return n.nodesPinPositions={},n.mainDivRef=r.a.createRef(),n.state={linksPositions:{}},n.getZoom=n.getZoom.bind(n),n.onUpdatePreviewLink=n.onUpdatePreviewLink.bind(n),n.onNodePinPositionsUpdate=n.onNodePinPositionsUpdate.bind(n),n.onSelectItem=n.onSelectItem.bind(n),n.onCreateLink=n.onCreateLink.bind(n),n.onConnectorUpdate=n.onConnectorUpdate.bind(n),n.onNodeMove=n.onNodeMove.bind(n),n.filterRenderedNodes=n.filterRenderedNodes.bind(n),n.filterRenderedLinks=n.filterRenderedLinks.bind(n),n}return gt(e,t),e.prototype.componentDidMount=function(){this.updateLinkPositions()},e.prototype.componentDidUpdate=function(){this.updateLinkPositions()},e.prototype.onSelectItem=function(t,e){var n=this.props,o=n.selectedItems,a=n.onSelectedItems;if(t||e){if(t&&e&&m.a.some(o,t)){var i=Pt([],o,!0),r=-1;o.forEach((function(e,n){e.id===t.id&&e.type===t.type&&(r=n)})),-1!==r&&i.splice(r,1),a(i)}else if(t&&!m.a.some(o,t)){i=Pt([],o,!0);e||(i=[]),i.push(t),a(i)}}else a([]);!e&&t&&a([t])},e.prototype.onUpdatePreviewLink=function(t){this.setState({draggedLink:t})},e.prototype.onNodePinPositionsUpdate=function(t,e){this.nodesPinPositions[t]=e},e.prototype.onCreateLink=function(t){var e=this.props.onCreateLink;e&&t.inputPinSide!==t.outputPinSide&&t.inputNodeId!==t.outputNodeId&&e(t)},e.prototype.onNodeMove=function(t,e,n,o){var a=this.props.onNodeMove;a&&a(t,e,n,o)},e.prototype.onConnectorUpdate=function(t,e,n){var o=this.props.onConnectorUpdate;o&&o(t,e,n)},e.prototype.getZoom=function(){return this.props.panZoomInfo.zoom},e.prototype.updateLinkPositions=function(){var t=this,e=this.props.links,n=this.state.linksPositions,a=!1,i=Object(h.c)(n,(function(i){Object.keys(e).forEach((function(n){var r=e[n];if(r.inputNodeId in t.nodesPinPositions!==!1&&r.outputNodeId in t.nodesPinPositions!==!1){var c=t.nodesPinPositions[r.inputNodeId][r.inputPinId],s=t.nodesPinPositions[r.outputNodeId][r.outputPinId];if(c&&s){var u=c[r.inputPinSide===o.LEFT?0:1],l=s[r.outputPinSide===o.LEFT?0:1];u&&l&&(n in i&&y(i[n].inputPinPosition,u)&&y(i[n].outputPinPosition,l)||(i[n]={linkId:n,inputPinPosition:u,outputPinPosition:l},a=!0))}}})),Object.keys(n).forEach((function(t){t in e||(delete i[t],a=!0)}))}));a&&this.setState({linksPositions:i})},e.prototype.filterRenderedNodes=function(){var t=this.props,e=t.nodes,n=t.panZoomInfo,o=this.mainDivRef.current;if(!o)return e;var a=-n.topLeftCorner.x/n.zoom-50,i=-n.topLeftCorner.y/n.zoom-50,r=a+o.offsetWidth/n.zoom+100,c=i+o.offsetHeight/n.zoom+100,s={},u=function(t,e,n){return t>=e&&t<=n};return Object.keys(e).forEach((function(t){var n=e[t],o=u(a,n.position.x,n.position.x+n.width)||u(n.position.x,a,r),l=u(i,n.position.y,n.position.y+1e3)||u(n.position.y,i,c);o&&l&&(s[t]=n)})),s},e.prototype.filterRenderedLinks=function(t){var e=this.props.links,n={};return Object.keys(e).forEach((function(o){var a=e[o];(t.includes(a.inputNodeId)||t.includes(a.outputNodeId))&&(n[o]=a)})),n},e.prototype.render=function(){var t=this.props,e=t.selectedItems,n=t.panZoomInfo,o=t.theme,a=t.customElements,i=this.props,c=i.onPanZoomInfo,s=i.createCustomConnectorComponent,u=i.createCustomElement,l=this.state,d=l.draggedLink,p=l.linksPositions,v=this.filterRenderedNodes(),h=this.filterRenderedLinks(Object.keys(v));return r.a.createElement(k.Provider,{value:o||x},r.a.createElement("div",{style:{width:"100%",height:"100%"},ref:this.mainDivRef},r.a.createElement(j,{panZoomInfo:n},r.a.createElement(O,{panZoomInfo:n,onPanZoomInfo:c,onSelectItem:this.onSelectItem},a&&r.a.createElement(bt,{customElements:a,onSelectItem:function(){},selectedItems:[],createCustomElement:u}),r.a.createElement(z,{links:h,linksPositions:p,draggedLink:d,selectedItems:e,onSelectItem:this.onSelectItem}),r.a.createElement(vt,{nodes:v,getZoom:this.getZoom,onNodeMove:this.onNodeMove,onCreateLink:this.onCreateLink,onUpdatePreviewLink:this.onUpdatePreviewLink,onConnectorUpdate:this.onConnectorUpdate,onNodePinPositionsUpdate:this.onNodePinPositionsUpdate,selectedItems:e,onSelectItem:this.onSelectItem,createCustomConnectorComponent:s})))))},e}(i.Component),kt=function(t){var e=t.name,n=t.onClick,o=t.onMouseEnter,a=t.onMouseLeave;return r.a.createElement("div",{onClick:n,onMouseEnter:o,onMouseLeave:a},e)},Ct=function(t){var e=t.items;return r.a.createElement(r.a.Fragment,null,Object.keys(e).map((function(t){var n=e[t];return r.a.createElement(kt,{name:n.name,onClick:n.onClick,onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,key:t})})))},jt=function(t){var e=t.menuTitle,n=t.items,o=r.a.useState(""),a=o[0],i=o[1],c=r.a.useCallback((function(t){i(t.currentTarget.value)}),[a]),s=Object(h.a)(n,(function(t){Object.keys(n).forEach((function(e){var o=n[e].name.toLowerCase(),i=a.toLowerCase();""===a||o.includes(i)||delete t[e]}))}));return r.a.createElement(r.a.Fragment,null,e,r.a.createElement("br",null),r.a.createElement("input",{value:a,onChange:c,placeholder:"Filter options"}),r.a.createElement(Ct,{items:s}))},wt=function(){return wt=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},wt.apply(this,arguments)},Et=function(t){var e=t.node,n=t.createCustomConnectorComponent,o=r.a.useRef(null),a=null;if(e&&o&&o.current){var i=o.current.getBoundingClientRect(),c=wt({},e);c.position={x:10,y:10},c.width=i.width-20,a=e?r.a.createElement(dt,{nodeId:"0",getZoom:function(){return 1},isNodeSelected:!0,node:c,onConnectorUpdate:function(){return null},onNodePinPositionsUpdate:function(){return null},createCustomConnectorComponent:n}):null}return r.a.createElement("div",{ref:o,style:{position:"relative",gridArea:"preview",overflow:"hidden",width:"500px",height:"500px"}},a)},_t=function(t){var e=t.nodesSchema,n=t.onNodeSelection,o=t.createCustomConnectorComponent,a=t.onMouseHover,i=r.a.useState(""),c=i[0],s=i[1],u={};Object.keys(e).forEach((function(t){u[t]={name:e[t].name,onMouseEnter:function(){s(t)},onMouseLeave:function(){s("")},onClick:function(){n(t)}}}));var l=r.a.useCallback((function(){a(!0)}),[a]),d=r.a.useCallback((function(){a(!1)}),[a]);return r.a.createElement("div",{style:{display:"flex"},onMouseLeave:d,onMouseEnter:l},r.a.createElement("div",null,r.a.createElement(jt,{menuTitle:"Add a new node",items:u})),r.a.createElement(Et,{node:c?e[c]:null,createCustomConnectorComponent:o}))},It=function(t){var e=t.onMouseHover,n=t.onDeleteSelection,o={};o.delete_selection={name:"Delete selection",onClick:function(){n()}};var a=r.a.useCallback((function(){e(!0)}),[e]),i=r.a.useCallback((function(){e(!1)}),[e]);return r.a.createElement("div",{onMouseLeave:i,onMouseEnter:a},r.a.createElement(jt,{menuTitle:"Selection management",items:o}))},Nt=n(5),Lt=n(6),Tt=function(){function t(e,n,o,a){Object(Nt.a)(this,t),this[d.b]=!0,this.name=void 0,this.position=void 0,this.width=void 0,this.connectors=void 0,this.name=e,this.width=n,this.position=o,this.connectors=a}return Object(Lt.a)(t,[{key:"compute",value:function(t,e,n){var i=this,r=Object.keys(t).find((function(e){return t[e]===i}));if(r){var c={};return Object.keys(this.connectors).forEach((function(s){var u=i.connectors[s];if(u.pinLayout===a.LEFT_PIN||u.pinLayout===a.BOTH_PINS){var l=function(t,e,n){var o=[];return Object.keys(t).forEach((function(a){var i=t[a];(i.inputNodeId===e&&i.inputPinId===n||i.outputNodeId===e&&i.outputPinId===n)&&o.push(i)})),o}(e,r,s);l.forEach((function(i){var l=i.inputNodeId!==r?i.inputNodeId:i.outputNodeId,d=i.inputNodeId===l?i.inputPinId:i.outputPinId;if((i.inputNodeId===l?i.inputPinSide:i.outputPinSide)!==o.LEFT||u.pinLayout!==a.BOTH_PINS){var p=t[l].compute(t,e,n);s in c||(c[s]=[]),c[s].push(p[d])}}))}})),this.computeSpecific(c,r,n)}return{}}}],[{key:"initFromJson",value:function(t,e){e.name=t.name,e.width=t.width,e.position=t.position,e.connectors=t.connectors}}]),t}(),St=n(8),Mt=n(7);!function(t){t.Canvas="canvas",t.Color="color",t.Number="number",t.Rectangle="rectangle",t.Rotate="rotate",t.Timer="timer",t.Translate="translate",t.IfElse="if-else",t.String="string",t.Split="split",t.Operation="operation",t.Log="log",t.Arc="arc",t.Check="check",t.Boolean="boolean"}(Ot||(Ot={}));var Ft=function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(){return Object(Nt.a)(this,n),e.call(this,Ot.Canvas,430,{x:0,y:0},{0:{name:"draw",pinLayout:a.LEFT_PIN,contentType:"canvas",data:{canvas_width:400,canvas_height:400,canvas_color:"white"}},1:{name:"width",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:400}},2:{name:"height",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:400}},3:{name:"color",pinLayout:a.LEFT_PIN,contentType:"none",data:{value:"white"},leftPinColor:"orange"}})}return Object(Lt.a)(n,[{key:"computeSpecific",value:function(t,e,n){var o=Number("1"in t?t[1][0]:this.connectors[1].data.value),a=Number("2"in t?t[2][0]:this.connectors[2].data.value),i="3"in t?t[3][0]:this.connectors[3].data.value;if("canvas_ctx"in this.connectors[0].data){var r=this.connectors[0].data.canvas_ctx;"clearRect"in r&&(n((function(n){return Object(d.a)(n,(function(n){n[e].connectors[0].data.canvas_width=Number(o),n[e].connectors[0].data.canvas_height=Number(a),n[e].connectors[0].data.canvas_color=i,n[e].connectors[1].data.disabled="1"in t,n[e].connectors[1].data.value=o,n[e].connectors[2].data.disabled="2"in t,n[e].connectors[2].data.value=a}))})),r.canvas.width=o,r.canvas.height=a,t[0]&&t[0].forEach((function(t){t(r)})))}return{}}}],[{key:"createFromJson",value:function(t){var e=new n;return Tt.initFromJson(t,e),e}}]),n}(Tt),zt=function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(){return Object(Nt.a)(this,n),e.call(this,Ot.Rectangle,200,{x:0,y:0},{0:{name:"draw",pinLayout:a.RIGHT_PIN,contentType:"none",data:{}},1:{name:"x",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},2:{name:"y",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},3:{name:"width",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:100,disabled:!1}},4:{name:"height",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:100,disabled:!1}},5:{name:"color",pinLayout:a.LEFT_PIN,contentType:"none",data:{value:"black"},leftPinColor:"orange"},6:{name:"type",pinLayout:a.NO_PINS,contentType:"select",data:{values:["fill","stroke","clear"],selected_index:0}},7:{name:"line width",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:1,disabled:!1}}})}return Object(Lt.a)(n,[{key:"computeSpecific",value:function(t,e,n){var o="1"in t?t[1][0]:this.connectors[1].data.value,a="2"in t?t[2][0]:this.connectors[2].data.value,i="3"in t?t[3][0]:this.connectors[3].data.value,r="4"in t?t[4][0]:this.connectors[4].data.value,c="5"in t?t[5][0]:this.connectors[5].data.value,s="7"in t?t[7][0]:this.connectors[7].data.value;n((function(n){return Object(d.a)(n,(function(n){n[e].connectors[1].data.disabled="1"in t,n[e].connectors[1].data.value=o,n[e].connectors[2].data.disabled="2"in t,n[e].connectors[2].data.value=a,n[e].connectors[3].data.disabled="3"in t,n[e].connectors[3].data.value=i,n[e].connectors[4].data.disabled="4"in t,n[e].connectors[4].data.value=r,n[e].connectors[7].data.disabled="7"in t,n[e].connectors[7].data.value=s}))}));var u=this.connectors[6].data.selected_index;return{0:function(t){if(0===u)t.fillStyle=c,t.fillRect(o,a,i,r),t.fillStyle="black";else if(1===u){t.strokeStyle=c;var e=t.lineWidth;t.lineWidth=s,t.strokeRect(o,a,i,r),t.lineWidth=e,t.strokeStyle="black"}else 2===u&&t.clearRect(o,a,i,r)}}}}],[{key:"createFromJson",value:function(t){var e=new n;return Tt.initFromJson(t,e),e}}]),n}(Tt),Rt=function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(){return Object(Nt.a)(this,n),e.call(this,Ot.Rotate,150,{x:0,y:0},{0:{name:"draw",pinLayout:a.BOTH_PINS,contentType:"none",data:{}},1:{name:"angle",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0}}})}return Object(Lt.a)(n,[{key:"computeSpecific",value:function(t,e,n){var o="1"in t?t[1][0]:this.connectors[1].data.value;o=o*Math.PI/180,n((function(n){return Object(d.a)(n,(function(n){n[e].connectors[1].data.disabled="1"in t,n[e].connectors[1].data.value=o}))}));return{0:function(e){e.rotate(o),t[0]&&t[0].forEach((function(t){t(e)})),e.rotate(-o)}}}}],[{key:"createFromJson",value:function(t){var e=new n;return Tt.initFromJson(t,e),e}}]),n}(Tt),Ut=function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(){return Object(Nt.a)(this,n),e.call(this,Ot.Number,170,{x:0,y:0},{0:{name:"number",pinLayout:a.RIGHT_PIN,contentType:"number",data:{value:0}}})}return Object(Lt.a)(n,[{key:"computeSpecific",value:function(){return{0:this.connectors[0].data.value}}}],[{key:"createFromJson",value:function(t){var e=new n;return Tt.initFromJson(t,e),e}}]),n}(Tt),Jt=function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(){return Object(Nt.a)(this,n),e.call(this,Ot.Color,150,{x:0,y:0},{0:{name:"color",pinLayout:a.RIGHT_PIN,contentType:"canvas",data:{canvas_width:40,canvas_height:40},rightPinColor:"orange"},1:{name:"red",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0}},2:{name:"green",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0}},3:{name:"blue",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0}},4:{name:"alpha",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:1}}})}return Object(Lt.a)(n,[{key:"computeSpecific",value:function(t,e,n){var o="1"in t?t[1][0]:this.connectors[1].data.value,a="2"in t?t[2][0]:this.connectors[2].data.value,i="3"in t?t[3][0]:this.connectors[3].data.value,r="4"in t?t[4][0]:this.connectors[4].data.value;a=a>255?255:a<0?0:a,i=i>255?255:i<0?0:i,r=r>1?1:r<0?0:r;var c="rgba(".concat(o=o>255?255:o<0?0:o,", ").concat(a,", ").concat(i,", ").concat(r,")"),s=this.width-30;if("canvas_ctx"in this.connectors[0].data){var u=this.connectors[0].data.canvas_ctx;"clearRect"in u&&(n((function(n){return Object(d.a)(n,(function(n){n[e].connectors[0].data.canvas_width=s,n[e].connectors[1].data.disabled="1"in t,n[e].connectors[1].data.value=o,n[e].connectors[2].data.disabled="2"in t,n[e].connectors[2].data.value=a,n[e].connectors[3].data.disabled="3"in t,n[e].connectors[3].data.value=i,n[e].connectors[4].data.disabled="4"in t,n[e].connectors[4].data.value=r}))})),u.canvas.width=s,u.fillStyle=c,u.fillRect(0,0,this.width,this.connectors[0].data.canvas_height))}return{0:c}}}],[{key:"createFromJson",value:function(t){var e=new n;return Tt.initFromJson(t,e),e}}]),n}(Tt),Ht=function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(){return Object(Nt.a)(this,n),e.call(this,Ot.Timer,150,{x:0,y:0},{0:{name:"count",pinLayout:a.RIGHT_PIN,contentType:"number",data:{value:"0"}},1:{name:"is_running",pinLayout:a.NO_PINS,contentType:"check_box",data:{value:!1}}})}return Object(Lt.a)(n,[{key:"computeSpecific",value:function(t){return{0:this.connectors[0].data.value}}}],[{key:"createFromJson",value:function(t){var e=new n;return Tt.initFromJson(t,e),e}}]),n}(Tt),Dt=function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(){return Object(Nt.a)(this,n),e.call(this,Ot.Translate,100,{x:0,y:0},{0:{name:"draw",pinLayout:a.BOTH_PINS,contentType:"none",data:{}},1:{name:"x",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0}},2:{name:"y",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0}}})}return Object(Lt.a)(n,[{key:"computeSpecific",value:function(t,e,n){var o="1"in t?t[1][0]:this.connectors[1].data.value,a="2"in t?t[2][0]:this.connectors[2].data.value;n((function(n){return Object(d.a)(n,(function(n){n[e].connectors[1].data.disabled="1"in t,n[e].connectors[1].data.value=o,n[e].connectors[2].data.disabled="2"in t,n[e].connectors[2].data.value=a}))}));return{0:function(e){e.translate(o,a),t[0]&&t[0].forEach((function(t){t(e)})),e.translate(-o,-a)}}}}],[{key:"createFromJson",value:function(t){var e=new n;return Tt.initFromJson(t,e),e}}]),n}(Tt),Zt=function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(){return Object(Nt.a)(this,n),e.call(this,Ot.IfElse,100,{x:0,y:0},{0:{name:"out_value",pinLayout:a.RIGHT_PIN,contentType:"none",data:{}},1:{name:"test",pinLayout:a.LEFT_PIN,contentType:"check_box",data:{value:!1}},2:{name:"if_value",pinLayout:a.LEFT_PIN,contentType:"none",data:{}},3:{name:"else_value",pinLayout:a.LEFT_PIN,contentType:"none",data:{}}})}return Object(Lt.a)(n,[{key:"computeSpecific",value:function(t){var e="1"in t?t[1][0]:this.connectors[1].data.value,n="2"in t?t[2][0]:null,o="3"in t?t[3][0]:null,a={};return e&&n?a={0:n}:!e&&n&&(a={0:o}),a}}],[{key:"createFromJson",value:function(t){var e=new n;return Tt.initFromJson(t,e),e}}]),n}(Tt),At=function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(){return Object(Nt.a)(this,n),e.call(this,Ot.String,100,{x:0,y:0},{0:{name:"string",pinLayout:a.RIGHT_PIN,contentType:"string",data:{value:""}}})}return Object(Lt.a)(n,[{key:"computeSpecific",value:function(){return{0:this.connectors[0].data.value}}}],[{key:"createFromJson",value:function(t){var e=new n;return Tt.initFromJson(t,e),e}}]),n}(Tt),Gt=function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(){return Object(Nt.a)(this,n),e.call(this,Ot.Split,100,{x:0,y:0},{0:{name:"out",pinLayout:a.RIGHT_PIN,contentType:"none",data:{}},1:{name:"input",pinLayout:a.LEFT_PIN,contentType:"string",data:{value:""}},2:{name:"separator",pinLayout:a.LEFT_PIN,contentType:"string",data:{value:"",height:"20px"}}})}return Object(Lt.a)(n,[{key:"computeSpecific",value:function(t){var e="1"in t?t[1][0]:this.connectors[1].data.value,n="2"in t?t[2][0]:this.connectors[2].data.value;return{0:n[0]?e.split(n[0]):e}}}],[{key:"createFromJson",value:function(t){var e=new n;return Tt.initFromJson(t,e),e}}]),n}(Tt),Bt=function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(){return Object(Nt.a)(this,n),e.call(this,Ot.Operation,160,{x:0,y:0},{0:{name:"output",pinLayout:a.RIGHT_PIN,contentType:"number",data:{value:0,disabled:!0}},1:{name:"type",pinLayout:a.NO_PINS,contentType:"select",data:{values:["add","substract","multiply","divide","modulo","minimum","maximum","exp","log","log10","negate","sin","cos","tan"],selected_index:0}},2:{name:"x",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},3:{name:"y",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}}})}return Object(Lt.a)(n,[{key:"computeSpecific",value:function(t,e,n){var o=Number("2"in t?t[2][0]:this.connectors[2].data.value),a=Number("3"in t?t[3][0]:this.connectors[3].data.value),i=0;switch(this.connectors[1].data.selected_index){case 0:i=o+a;break;case 1:i=o-a;break;case 2:i=o*a;break;case 3:i=isNaN(o/a)?0:o/a;break;case 4:i=isNaN(o%a)?0:o%a;break;case 5:i=o>a?a:o;break;case 6:i=o>a?o:a;break;case 7:i=Math.pow(o,a);break;case 8:i=Math.log(o);break;case 9:i=Math.log10(o);break;case 10:i=-o;break;case 11:i=Math.sin(o);break;case 12:i=Math.cos(o);break;case 13:i=Math.tan(o)}return n((function(n){return Object(d.a)(n,(function(n){n[e].connectors[0].data.value=i,n[e].connectors[2].data.disabled="2"in t,n[e].connectors[2].data.value=o,n[e].connectors[3].data.disabled="3"in t,n[e].connectors[3].data.value=a}))})),{0:i}}}],[{key:"createFromJson",value:function(t){var e=new n;return Tt.initFromJson(t,e),e}}]),n}(Tt),Wt=function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(){var t;return Object(Nt.a)(this,n),(t=e.call(this,Ot.Log,100,{x:0,y:0},{0:{name:"log",pinLayout:a.LEFT_PIN,contentType:"none",data:{},leftPinColor:"red"},1:{name:"log",pinLayout:a.NO_PINS,contentType:"button",data:{label:"log"}}})).inputs=void 0,t.inputs=[],t.connectors[1].data.onClick=t.log,t}return Object(Lt.a)(n,[{key:"log",value:function(t){t.inputs.forEach((function(t){console.log(t)}))}},{key:"computeSpecific",value:function(t,e,n){return t[0]&&!v.a.isEqual(t[0],this.inputs)&&n((function(n){return Object(d.a)(n,(function(n){n[e].inputs=t[0]}))})),{}}}],[{key:"createFromJson",value:function(t){var e=new n;return Tt.initFromJson(t,e),e.connectors[1].data.onClick=e.log,e}}]),n}(Tt),Vt=function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(){return Object(Nt.a)(this,n),e.call(this,Ot.Arc,200,{x:0,y:0},{0:{name:"draw",pinLayout:a.RIGHT_PIN,contentType:"none",data:{}},1:{name:"x",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},2:{name:"y",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},3:{name:"radius",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:100,disabled:!1}},4:{name:"start angle",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},5:{name:"end angle",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:2*Math.PI,disabled:!1}},6:{name:"color",pinLayout:a.LEFT_PIN,contentType:"none",data:{value:"black"},leftPinColor:"orange"},7:{name:"type",pinLayout:a.NO_PINS,contentType:"select",data:{values:["fill","stroke"],selected_index:0}},8:{name:"line width",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:1,disabled:!1}},9:{name:"counterclockwise",pinLayout:a.LEFT_PIN,contentType:"check_box",data:{value:!1}}})}return Object(Lt.a)(n,[{key:"computeSpecific",value:function(t,e,n){var o="1"in t?t[1][0]:this.connectors[1].data.value,a="2"in t?t[2][0]:this.connectors[2].data.value,i="3"in t?t[3][0]:this.connectors[3].data.value,r="4"in t?t[4][0]:this.connectors[4].data.value,c="5"in t?t[5][0]:this.connectors[5].data.value,s="6"in t?t[6][0]:this.connectors[6].data.value,u="8"in t?t[8][0]:this.connectors[8].data.value,l="9"in t?t[9][0]:this.connectors[9].data.value;n((function(n){return Object(d.a)(n,(function(n){n[e].connectors[1].data.disabled="1"in t,n[e].connectors[1].data.value=o,n[e].connectors[2].data.disabled="2"in t,n[e].connectors[2].data.value=a,n[e].connectors[3].data.disabled="3"in t,n[e].connectors[3].data.value=i,n[e].connectors[4].data.disabled="4"in t,n[e].connectors[4].data.value=r,n[e].connectors[5].data.disabled="5"in t,n[e].connectors[5].data.value=c,n[e].connectors[8].data.disabled="8"in t,n[e].connectors[8].data.value=u}))}));var p=this.connectors[7].data.selected_index;return{0:function(t){if(0===p)t.fillStyle=s,t.beginPath(),t.arc(o,a,i,r,c,l),t.closePath(),t.fill(),t.fillStyle="black";else if(1===p){t.strokeStyle=s;var e=t.lineWidth;t.lineWidth=u,t.beginPath(),t.arc(o,a,i,r,c,l),t.closePath(),t.stroke(),t.lineWidth=e,t.strokeStyle="black"}}}}}],[{key:"createFromJson",value:function(t){var e=new n;return Tt.initFromJson(t,e),e}}]),n}(Tt),qt=function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(){return Object(Nt.a)(this,n),e.call(this,Ot.Check,160,{x:0,y:0},{0:{name:"output",pinLayout:a.RIGHT_PIN,contentType:"none",data:{value:!1,disabled:!0}},1:{name:"type",pinLayout:a.NO_PINS,contentType:"select",data:{values:["===","!==","<","<=",">",">="],selected_index:0}},2:{name:"x",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},3:{name:"y",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}}})}return Object(Lt.a)(n,[{key:"computeSpecific",value:function(t,e,n){var o=Number("2"in t?t[2][0]:this.connectors[2].data.value),a=Number("3"in t?t[3][0]:this.connectors[3].data.value),i=!1;switch(this.connectors[1].data.selected_index){case 0:i=o===a;break;case 1:i=o!==a;break;case 2:i=o<a;break;case 3:i=o<=a;break;case 4:i=o>a;break;case 5:i=o>=a}return n((function(n){return Object(d.a)(n,(function(n){n[e].connectors[0].data.value=i,n[e].connectors[2].data.disabled="2"in t,n[e].connectors[2].data.value=o,n[e].connectors[3].data.disabled="3"in t,n[e].connectors[3].data.value=a}))})),{0:i}}}],[{key:"createFromJson",value:function(t){var e=new n;return Tt.initFromJson(t,e),e}}]),n}(Tt),Xt=function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(){return Object(Nt.a)(this,n),e.call(this,Ot.Boolean,160,{x:0,y:0},{0:{name:"output",pinLayout:a.RIGHT_PIN,contentType:"none",data:{value:!1,disabled:!0}},1:{name:"type",pinLayout:a.NO_PINS,contentType:"select",data:{values:["===","!==","&&","||","!"],selected_index:0}},2:{name:"x",pinLayout:a.LEFT_PIN,contentType:"check_box",data:{value:!1}},3:{name:"y",pinLayout:a.LEFT_PIN,contentType:"check_box",data:{value:!1}}})}return Object(Lt.a)(n,[{key:"computeSpecific",value:function(t,e,n){var o="2"in t?t[2][0]:this.connectors[2].data.value,a="3"in t?t[3][0]:this.connectors[3].data.value,i=!1;switch(this.connectors[1].data.selected_index){case 0:i=o===a;break;case 1:i=o!==a;break;case 2:i=o&&a;break;case 3:i=o||a;break;case 4:i=!o}return n((function(n){return Object(d.a)(n,(function(n){n[e].connectors[0].data.value=i,n[e].connectors[2].data.disabled="2"in t,n[e].connectors[2].data.value=o,n[e].connectors[3].data.disabled="3"in t,n[e].connectors[3].data.value=a}))})),{0:i}}}],[{key:"createFromJson",value:function(t){var e=new n;return Tt.initFromJson(t,e),e}}]),n}(Tt);var Yt=n(9),Kt=function(t){var e=Object(i.useRef)(null);return Object(i.useEffect)((function(){var n=t.nodeId,o=t.cId,a=t.connector,i=t.onConnectorUpdate;if(e.current){var r=e.current.getContext("2d");if(r&&(!("canvas_ctx"in a.data)||r!==a.data.canvas_ctx))i(n,o,Object(d.a)(a,(function(t){t.data.canvas_ctx=r})))}}),[e,t]),Object(Yt.jsxs)(Yt.Fragment,{children:[Object(Yt.jsx)("div",{style:{position:"absolute",zIndex:.1,backgroundColor:t.connector.data.canvas_color,width:t.connector.data.canvas_width,height:t.connector.data.canvas_height}}),Object(Yt.jsx)("canvas",{style:{position:"relative",imageRendering:"auto"},width:t.connector.data.canvas_width,height:t.connector.data.canvas_height,ref:e})]})},Qt=n(26),$t=n(97),te=function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(t){var o;return Object(Nt.a)(this,n),(o=e.call(this,t)).onColorChange=o.onColorChange.bind(Object(Qt.a)(o)),o}return Object(Lt.a)(n,[{key:"onColorChange",value:function(t){var e=this.props,n=e.nodeId,o=e.cId,a=e.connector;(0,e.onConnectorUpdate)(n,o,Object(d.a)(a,(function(e){e.data.color="rgba(".concat(t.rgb.r,", ").concat(t.rgb.g,", ").concat(t.rgb.b,", ").concat(t.rgb.a,")")})))}},{key:"render",value:function(){var t=this.props.connector;if(!("color"in t.data)){return Object(Yt.jsx)(H,{message:"'color' connector types must provide a string field named 'color'"})}return Object(Yt.jsx)($t.a,{color:t.data.color,onChange:this.onColorChange})}}]),n}(i.Component),ee=n(98),ne=(n(216),function(t){Object(St.a)(n,t);var e=Object(Mt.a)(n);function n(){return Object(Nt.a)(this,n),e.apply(this,arguments)}return Object(Lt.a)(n,[{key:"render",value:function(){return Object(Yt.jsxs)(Yt.Fragment,{children:["ICI",Object(Yt.jsx)(ee.a,{onChange:function(t){console.log(t)}})]})}}]),n}(i.Component)),oe=ne;function ae(t){var e=t.connector;return"color"===e.contentType?Object(Yt.jsx)(te,Object(u.a)({},t)):"slider"===e.contentType?Object(Yt.jsx)(oe,Object(u.a)({},t)):"canvas"===e.contentType?Object(Yt.jsx)(Kt,Object(u.a)({},t)):null}var ie=function(){var t=r.a.useState(null),e=Object(l.a)(t,2),n=e[0],o=e[1],a=r.a.useState(!1),c=Object(l.a)(a,2),s=c[0],p=c[1],h=r.a.useState({zoom:1,topLeftCorner:{x:0,y:0}}),f=Object(l.a)(h,2),m=f[0],y=f[1],g=r.a.useState([]),P=Object(l.a)(g,2),O=P[0],x=P[1],k=localStorage.getItem("nodes"),C=localStorage.getItem("links"),j=k?JSON.parse(k):{},w=C?JSON.parse(C):{};k&&Object.keys(j).forEach((function(t){j[t]=function(t){var e=void 0;switch(t.name){case Ot.Canvas:e=Ft.createFromJson(t);break;case Ot.Color:e=Jt.createFromJson(t);break;case Ot.Number:e=Ut.createFromJson(t);break;case Ot.Rectangle:e=zt.createFromJson(t);break;case Ot.Rotate:e=Rt.createFromJson(t);break;case Ot.Timer:e=Ht.createFromJson(t);break;case Ot.Translate:e=Dt.createFromJson(t);break;case Ot.IfElse:e=Zt.createFromJson(t);break;case Ot.String:e=At.createFromJson(t);break;case Ot.Split:e=Gt.createFromJson(t);break;case Ot.Operation:e=Bt.createFromJson(t);break;case Ot.Log:e=Wt.createFromJson(t);break;case Ot.Arc:e=Vt.createFromJson(t);break;case Ot.Check:e=qt.createFromJson(t);break;case Ot.Boolean:e=Xt.createFromJson(t)}if(!e)throw new Error("Error while reading node from json");return e}(j[t])}));var E=r.a.useState(j),_=Object(l.a)(E,2),I=_[0],N=_[1],L=r.a.useState(w),T=Object(l.a)(L,2),S=T[0],M=T[1];localStorage.setItem("nodes",JSON.stringify(I)),localStorage.setItem("links",JSON.stringify(S));var F={0:new Ft,1:new zt,2:new Rt,3:new Ut,4:new Ht,5:new Jt,6:new Dt,7:new Zt,8:new At,9:new Gt,10:new Bt,11:new Wt,12:new Vt,13:new qt,14:new Xt};r.a.useEffect((function(){Object.keys(I).forEach((function(t){var e=I[t];if(e instanceof Ft||e instanceof Wt)try{e.compute(I,S,N)}catch(n){console.error(n)}}))}),[I,S]),r.a.useEffect((function(){var t=setInterval((function(){var t=!1,e=Object(d.c)(I,(function(e){for(var n=0,o=Object.keys(I);n<o.length;n++){var a=o[n];"timer"===e[a].name&&e[a].connectors[1].data.value&&(e[a].connectors[0].data.value=(Number(e[a].connectors[0].data.value)+1).toString(),t=!0)}}));t&&N(e)}),1e3/60);return function(){return clearInterval(t)}}),[I,S]);var z=r.a.useCallback((function(t,e,n,o){N((function(a){return Object(d.c)(a,(function(a){a[t].position={x:e,y:n},a[t].width=o}))}))}),[]),R=r.a.useCallback((function(t){M((function(e){return Object(d.c)(e,(function(e){e[b()]=t}))}))}),[]),U=r.a.useCallback((function(){var t=O.filter((function(t){return"node"===t.type})).map((function(t){return t.id})),e=O.filter((function(t){return"link"===t.type})).map((function(t){return t.id}));N((function(e){return Object(d.c)(e,(function(e){t.forEach((function(t){delete e[t]}))}))})),M((function(n){return Object(d.c)(n,(function(o){Object.keys(n).forEach((function(e){var a=n[e];(t.includes(a.inputNodeId)||t.includes(a.outputNodeId))&&delete o[e]})),e.forEach((function(t){delete o[t]}))}))}))}),[O]),J=r.a.useCallback((function(t){n&&(N((function(e){return Object(d.c)(e,(function(e){var o=v.a.clone(F[t]),a=-m.topLeftCorner.x/m.zoom+n.x/m.zoom,i=-m.topLeftCorner.y/m.zoom+n.y/m.zoom;o.position={x:a,y:i},e[b()]=o}))})),p(!1),o(null))}),[m,n,F]),H=r.a.useCallback((function(t,e,n){N((function(o){return Object(d.c)(o,(function(o){o[t].connectors[e]=n}))}))}),[]),D=r.a.useCallback((function(t){t.preventDefault(),n?(p(!1),o(null)):o({x:t.pageX,y:t.pageY})}),[n]),Z=r.a.useCallback((function(){n&&!s&&(p(!1),o(null))}),[s,n,o]),A=Object(i.useCallback)((function(){var t={nodes:I,links:S},e=document.createElement("a");e.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(t))),e.setAttribute("download","oura-node-editor.json"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}),[I,S]),G=Object(i.useCallback)((function(t){if(!(t.target.files.size<1)){var e=new FileReader;e.onload=function(t){if(t.target&&t.target.result&&t.target.result){var e=JSON.parse(atob(t.target.result.substring(29)));N(e.nodes),M(e.links)}},e.readAsDataURL(t.target.files[0])}}),[]),B=Object(i.useCallback)((function(){N({}),M({})}),[]),W=null;n&&0===O.length?W=Object(Yt.jsx)("div",{style:{width:640,height:500,position:"absolute",top:n.y,left:n.x,backgroundColor:"white"},children:Object(Yt.jsx)(_t,{nodesSchema:F,onNodeSelection:J,onMouseHover:p,createCustomConnectorComponent:ae})}):n&&(W=Object(Yt.jsx)("div",{style:{width:640,height:480,position:"absolute",top:n.y,left:n.x,backgroundColor:"white"},children:Object(Yt.jsx)(It,{onMouseHover:p,onDeleteSelection:U})}));var V={font:"bold 11px Arial",textDecoration:"none",backgroundColor:"#EEEEEE",color:"#333333",padding:"2px 6px 2px 6px",borderTop:"1px solid #CCCCCC",borderRight:"1px solid #333333",borderBottom:"1px solid #333333",borderLeft:"1px solid #CCCCCC"};return Object(Yt.jsxs)(Yt.Fragment,{children:[Object(Yt.jsxs)("div",{style:{width:"100%",height:"100%"},onContextMenu:D,onMouseDown:Z,tabIndex:0,children:[Object(Yt.jsx)(xt,{panZoomInfo:m,nodes:I,links:S,selectedItems:O,customElements:{},onPanZoomInfo:y,onSelectedItems:x,onNodeMove:z,onCreateLink:R,onConnectorUpdate:H,createCustomConnectorComponent:ae}),W]}),Object(Yt.jsx)("button",{onClick:A,style:Object(u.a)({position:"absolute",left:5,bottom:5},V),children:"save"}),Object(Yt.jsx)("label",{htmlFor:"files",className:"btn",style:Object(u.a)({position:"absolute",left:55,bottom:5},V),children:"load"}),Object(Yt.jsx)("input",{onChange:G,id:"files",style:{visibility:"hidden"},type:"file"}),Object(Yt.jsx)("button",{onClick:B,style:Object(u.a)({position:"absolute",right:5,bottom:5},V),children:"reset"})]})},re=function(){return Object(Yt.jsx)("div",{style:{width:"100%",height:"100vh"},className:"App",children:Object(Yt.jsx)(ie,{})})};s.a.render(Object(Yt.jsx)(r.a.StrictMode,{children:Object(Yt.jsx)(re,{})}),document.getElementById("root"))}},[[217,1,2]]]);
//# sourceMappingURL=main.6f079722.chunk.js.map
(this["webpackJsonpoura-canvas-creator"]=this["webpackJsonpoura-canvas-creator"]||[]).push([[0],{32:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var o,a,i=n(4),r=n.n(i),c=n(23),u=(n(32),n(15)),s=n(13),l=n(6),d=n(12),p=n(10),v=n.n(p);function h(e,t){return e.x===t.x&&e.y===t.y}function f(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}!function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"}(o||(o={})),function(e){e[e.NO_PINS=0]="NO_PINS",e[e.LEFT_PIN=1]="LEFT_PIN",e[e.RIGHT_PIN=2]="RIGHT_PIN",e[e.BOTH_PINS=3]="BOTH_PINS"}(a||(a={}));var m=n(22),y=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),b=function(e){function t(t){var n=e.call(this,t)||this;return n.panStartPosition=null,n.shiftKey=!1,n.state={panDisabled:!1},n.onMouseDown=n.onMouseDown.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n.onZoomChange=n.onZoomChange.bind(n),n.onPanning=n.onPanning.bind(n),n.onPanningStart=n.onPanningStart.bind(n),n.onPanningStop=n.onPanningStop.bind(n),n}return y(t,e),t.prototype.onMouseDown=function(e){this.shiftKey=e.shiftKey;var t=e.target,n=!1;"string"===typeof t.id&&(n="link_canvas"===t.id);var o=!1;"string"===typeof t.className&&(o=t.className.includes("react-transform-wrapper")),this.setState({panDisabled:0!==e.button||!n&&!o})},t.prototype.onMouseUp=function(){this.setState({panDisabled:!1})},t.prototype.onZoomChange=function(e){(0,this.props.onPanZoomInfo)({zoom:e.state.scale,topLeftCorner:{x:e.state.positionX,y:e.state.positionY}})},t.prototype.onPanning=function(e){(0,this.props.onPanZoomInfo)({zoom:e.state.scale,topLeftCorner:{x:e.state.positionX,y:e.state.positionY}})},t.prototype.onPanningStart=function(e){this.panStartPosition={x:e.state.positionX,y:e.state.positionY}},t.prototype.onPanningStop=function(e){var t=this.props.onSelectItem,n=e.state.positionX,o=e.state.positionY;this.panStartPosition&&this.panStartPosition.x===n&&this.panStartPosition.y===o&&t(null,this.shiftKey)},t.prototype.render=function(){var e=this.props,t=e.panZoomInfo,n=e.children,o=this.state.panDisabled;return i.createElement("div",{id:"panzoom",style:{position:"relative",width:"100%",height:"100%"},onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},i.createElement(m.b,{limitToBounds:!1,minScale:.35,panning:{excluded:["input","select","textarea","button","path"],disabled:o,velocityDisabled:!0},doubleClick:{disabled:!0},wheel:{step:.1},onWheel:this.onZoomChange,onPanningStart:this.onPanningStart,onPanning:this.onPanning,onPanningStop:this.onPanningStop,initialScale:t.zoom,initialPositionX:t.topLeftCorner.x,initialPositionY:t.topLeftCorner.y},i.createElement(m.a,null,i.createElement("div",{style:{height:"100vh",width:"100vw"}},n))))},t}(i.Component);var O={theme:{node:{selected:{boxShadow:"0px 0px 0px 2px white",borderRadius:"10px 10px 10px 10px"},header:{backgroundColor:"orange",color:"white",borderRadius:"10px 10px 0px 0px",height:"20px",cursor:"grab",overflow:"hidden",paddingLeft:"10px"},body:{color:"white",backgroundColor:"rgba(63, 63, 63, 0.75)",cursor:"grab"},footer:{borderRadius:"0px 0px 10px 10px",height:"10px",backgroundColor:"rgba(63, 63, 63, 0.75)",cursor:"ew-resize"},basePin:{backgroundColor:"rgba(199, 199, 41, 1)",borderRadius:"5px 5px 5px 5px",cursor:"grab"},customPins:{string:{backgroundColor:"red",transform:"rotate(45deg)"}}},link:{selected:{stroke:"white",strokeWidth:"3px",fill:"none"},unselected:{stroke:"rgba(170, 170, 170, 0.75)",strokeWidth:"3px",fill:"none"}},connectors:{leftText:{width:"40%",textOverflow:"ellipsis",overflow:"hidden"},string:{width:"100%",backgroundColor:"#585858",color:"white",border:0,outline:"none"},number:{width:"60%",boxSizing:"border-box",backgroundColor:"#585858",color:"white",border:0,outline:"none",textAlign:"right",borderRadius:"8px",paddingRight:"5px"},select:{width:"60%",backgroundColor:"#585858",boxSizing:"border-box",color:"white",border:0,outline:"none",textAlign:"right",borderRadius:"8px",paddingRight:"5px"},button:{width:"100%",backgroundColor:"#585858",color:"white",border:0,outline:"none"}}},buildBackgroundStyle:function(e){var t=String(200*e.zoom);return{backgroundColor:"#232323",backgroundPosition:"".concat(e.topLeftCorner.x,"px ").concat(e.topLeftCorner.y,"px"),backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='".concat(t,"' height='").concat(t,"' viewBox='0 0 100 100'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='black' fill-opacity='0.4'%3E%3Cpath opacity='.5' d='M96 95h4v1h-4v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9zm-1 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9z'/%3E%3Cpath d='M6 5V0H5v5H0v1h5v94h1V6h94V5H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")")}}},g=Object(i.createContext)(O),k=function(){return k=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},k.apply(this,arguments)};function j(e){var t=Object(i.useContext)(g).buildBackgroundStyle,n=e.panZoomInfo,o=e.children,a={position:"relative",top:"0",left:"0",width:"100%",height:"100%",overflow:"hidden"};return t&&(a=k(k({},a),t(n))),r.a.createElement("div",{style:a},o)}var P=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),x=function(){return x=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},x.apply(this,arguments)},I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype.shouldComponentUpdate=function(e){return!p.isEqual(this.props,e)},t.prototype.onSelectLink=function(e){var t=this.props,n=t.linkId,o=t.onSelectLink;o&&n&&o(n,e.shiftKey)},t.prototype.render=function(){var e,t,n,o,a,i,c=this.context.theme,u=this.props,s=u.linkId,l=u.linkPosition,d=u.isLinkSelected,p=l.inputPinPosition.x,v=l.inputPinPosition.y,h=l.outputPinPosition.x,f=l.outputPinPosition.y,m=function(e,t){var n=Math.abs(t.x-e.x)/2,o=t.x<e.x?t.x+n:t.x-n,a=Math.abs(t.y-e.y)/2;return{x:o,y:t.y<e.y?t.y+a:t.y-a}}(l.inputPinPosition,l.outputPinPosition),y="M".concat(p,",").concat(v," C").concat(m.x,",").concat(v," ").concat(m.x,",").concat(f," ").concat(h,",").concat(f),b=d?x(x({},null===(e=null===c||void 0===c?void 0:c.link)||void 0===e?void 0:e.selected),null===(n=null===(t=this.props.link)||void 0===t?void 0:t.theme)||void 0===n?void 0:n.selected):x(x({},null===(o=null===c||void 0===c?void 0:c.link)||void 0===o?void 0:o.unselected),null===(i=null===(a=this.props.link)||void 0===a?void 0:a.theme)||void 0===i?void 0:i.unselected);return r.a.createElement("path",{id:"link_".concat(s),d:y,style:b,onClick:this.onSelectLink.bind(this)})},t}(i.Component),N=I;I.contextType=g;var C=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),w=function(){return w=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},w.apply(this,arguments)},E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.shouldComponentUpdate=function(e){return!p.isEqual(this.props,e)},t.prototype.onSelectLink=function(e){var t=this.props,n=t.linkId,o=t.onSelectLink;o&&n&&o(n,e.shiftKey)},t.prototype.render=function(){var e,t,n,o,a,i,c=this.context.theme,u=this.props,s=u.linkId,l=u.linkPosition,d=u.isLinkSelected?w(w({},null===(e=null===c||void 0===c?void 0:c.link)||void 0===e?void 0:e.selected),null===(n=null===(t=this.props.link)||void 0===t?void 0:t.theme)||void 0===n?void 0:n.selected):w(w({},null===(o=null===c||void 0===c?void 0:c.link)||void 0===o?void 0:o.unselected),null===(i=null===(a=this.props.link)||void 0===a?void 0:a.theme)||void 0===i?void 0:i.unselected);return r.a.createElement("line",{id:"link_".concat(s),x1:l.inputPinPosition.x,y1:l.inputPinPosition.y,x2:l.outputPinPosition.x,y2:l.outputPinPosition.y,style:d,onClick:this.onSelectLink.bind(this)})},t}(i.Component),T=E;E.contextType=g;var _=function(){return _=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},_.apply(this,arguments)};function L(e){var t=e.link;return"line"===(null===t||void 0===t?void 0:t.linkType)?r.a.createElement(T,_({},e)):r.a.createElement(N,_({},e))}function S(e){var t=e.links,n=e.linksPositions,o=e.selectedItems,a=e.draggedLink,i=e.onSelectItem;return r.a.createElement("svg",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",overflow:"visible"},id:"link_canvas"},Object.keys(t).filter((function(e){return e in n})).map((function(e){return L({linkId:e,link:t[e],key:e,linkPosition:n[e],isLinkSelected:v.a.some(o,{id:e,type:"link"}),onSelectLink:function(e,t){return i({id:e,type:"link"},t)}})})),a&&L({linkPosition:a,isLinkSelected:!1}))}var F=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return F(t,e),t.prototype.shouldComponentUpdate=function(e){return!p.isEqual(this.props,e)},t.prototype.render=function(){var e=this.props.connector;return r.a.createElement("div",{className:"node-background",style:{textAlign:e.pinLayout===a.RIGHT_PIN?"right":"left"}},e.name)},t}(i.Component),R=M,J=function(e){var t=e.message;return r.a.createElement("div",{style:{color:"red"}},"error: ".concat(t))},z=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),U=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return z(t,e),t.prototype.onChange=function(){var e=this.props,t=e.nodeId,n=e.cId,o=e.connector;(0,e.onConnectorUpdate)(t,n,Object(d.a)(o,(function(e){e.data.value=!e.data.value})))},t.prototype.render=function(){var e=this.props.connector;if(!("value"in e.data)){return r.a.createElement(J,{message:"'check_box' connector types must provide a bool field named 'value'"})}return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{tabIndex:-1,checked:e.data.value,onChange:this.onChange,type:"checkbox",style:{backgroundColor:"#585858",color:"white",border:0,outline:"none"}}),e.name)},t}(i.Component),H=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),A=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return H(t,e),t.prototype.shouldComponentUpdate=function(e){return!v.a.isEqual(this.props,e)},t.prototype.onChange=function(e){var t=this.props,n=t.nodeId,o=t.cId,a=t.connector,i=t.onConnectorUpdate;isNaN(Number(e.currentTarget.value))||i(n,o,Object(d.a)(a,(function(t){t.data.value=e.currentTarget.value})))},t.prototype.render=function(){var e,t,n=this.context.theme,o=this.props.connector;if(!("value"in o.data)){return r.a.createElement(J,{message:"'number' connector types must provide a string field named 'value'"})}return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{className:"node-background",style:null===(e=null===n||void 0===n?void 0:n.connectors)||void 0===e?void 0:e.leftText},o.name),r.a.createElement("input",{disabled:"disabled"in o.data&&o.data.disabled,style:null===(t=null===n||void 0===n?void 0:n.connectors)||void 0===t?void 0:t.number,value:o.data.value,onChange:this.onChange,placeholder:o.name}))},t}(i.Component),D=A;A.contextType=g;var Z=function(e){var t,n,o=e.connector,a=e.nodeId,c=e.cId,u=e.onConnectorUpdate,s=Object(i.useContext)(g).theme;if(!("values"in o.data)||!("selected_index"in o.data)){return r.a.createElement(J,{message:"'select' connector types must provide a string array field named 'values' and a number field 'selected_index'"})}var l=Object(i.useCallback)((function(e){var t=Object(d.a)(o,(function(t){t.data.selected_index=e}));u(a,c,t)}),[u,a,c,o]);return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{className:"node-background",style:null===(t=null===s||void 0===s?void 0:s.connectors)||void 0===t?void 0:t.leftText},o.name),r.a.createElement("select",{onChange:function(e){return l(e.target.selectedIndex)},style:null===(n=null===s||void 0===s?void 0:s.connectors)||void 0===n?void 0:n.select,defaultValue:o.data.values[o.data.selected_index]},o.data.values.map((function(e){return r.a.createElement("option",{key:e,value:e},e)}))))},G=function(e){var t,n=e.connector,o=e.node,a=Object(i.useContext)(g).theme;if(!("label"in n.data)||!("onClick"in n.data)){return r.a.createElement(J,{message:"'button' connector types must provide a string field named 'label' and a callback 'onClick'"})}return r.a.createElement("button",{style:null===(t=null===a||void 0===a?void 0:a.connectors)||void 0===t?void 0:t.button,onClick:function(){return n.data.onClick(o)}},n.data.label)},B=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),V=function(){return V=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},V.apply(this,arguments)},W=function(e){function t(t){var n=e.call(this,t)||this;return n.textAreaRef=r.a.createRef(),n.onChange=n.onChange.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n}return B(t,e),t.prototype.shouldComponentUpdate=function(e){return!v.a.isEqual(this.props,e)},t.prototype.onChange=function(e){var t=this.props,n=t.nodeId,o=t.cId,a=t.connector;(0,t.onConnectorUpdate)(n,o,Object(d.a)(a,(function(t){t.data.value=e.currentTarget.value})))},t.prototype.onMouseUp=function(){if(this.textAreaRef.current){var e=this.props,t=e.nodeId,n=e.cId,o=e.connector,a=e.onConnectorUpdate,i=this.textAreaRef.current.style.height;a(t,n,Object(d.a)(o,(function(e){e.data.height=i})))}},t.prototype.render=function(){var e,t=this.context.theme,n=this.props.connector;if(!("value"in n.data)){return r.a.createElement(J,{message:"'text_area' connector types must provide a string field named 'value'"})}var o="height"in n.data?n.data.height:100;return r.a.createElement("textarea",{ref:this.textAreaRef,style:V({height:o,whiteSpace:"pre",resize:"vertical"},null===(e=null===t||void 0===t?void 0:t.connectors)||void 0===e?void 0:e.string),value:n.data.value,onChange:this.onChange,onMouseUp:this.onMouseUp,placeholder:n.name})},t}(i.Component),q=W;W.contextType=g;var Y=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),X=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return Y(t,e),t.prototype.shouldComponentUpdate=function(e){return!v.a.isEqual(this.props,e)},t.prototype.onChange=function(e){var t=this.props,n=t.nodeId,o=t.cId,a=t.connector;(0,t.onConnectorUpdate)(n,o,Object(d.a)(a,(function(t){t.data.value=e.currentTarget.value})))},t.prototype.render=function(){var e,t,n=this.context.theme,o=this.props.connector;if(!("value"in o.data)){return r.a.createElement(J,{message:"'string' connector types must provide a string field named 'value'"})}return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{className:"node-background",style:null===(e=null===n||void 0===n?void 0:n.connectors)||void 0===e?void 0:e.leftText},o.name),r.a.createElement("input",{disabled:"disabled"in o.data&&o.data.disabled,style:null===(t=null===n||void 0===n?void 0:n.connectors)||void 0===t?void 0:t.number,value:o.data.value,onChange:this.onChange,placeholder:o.name}))},t}(i.Component),K=X;X.contextType=g;var Q=function(){return Q=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Q.apply(this,arguments)};var $=function(){return $=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},$.apply(this,arguments)},ee=function(){function e(){this.onMouseMoveCb=function(){return null},this.onMouseUpCb=function(){return null},this.initialPos={x:0,y:0},this.finalPos={x:0,y:0},this.tmpPos={x:0,y:0},this.getZoom=function(){return 1},this.targetClassName="",this.lastZoom=0,this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this)}return e.prototype.onMouseDown=function(e,t,n,o,a){window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp),this.getZoom=n,this.initialPos=t,this.finalPos={x:t.x,y:t.y};var i=n();this.lastZoom=i,this.tmpPos={x:e.pageX/i,y:e.pageY/i},this.onMouseMoveCb=o,this.onMouseUpCb=a},e.prototype.onMouseMove=function(e){var t=this.getZoom(),n={x:e.pageX/this.lastZoom-this.tmpPos.x,y:e.pageY/this.lastZoom-this.tmpPos.y};this.finalPos.x+=n.x,this.finalPos.y+=n.y,this.tmpPos={x:e.pageX/t,y:e.pageY/t};var o=e.target.className;"string"===typeof o&&(this.targetClassName=o),this.onMouseMoveCb($({},this.initialPos),$({},this.finalPos),n,this.targetClassName),this.lastZoom=t},e.prototype.onMouseUp=function(e){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),this.onMouseUpCb($({},this.initialPos),$({},this.finalPos),e)},e}(),te=function(){return te=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},te.apply(this,arguments)},ne=function(e){var t,n,o,a,c=e.className,u=e.contentType,s=e.leftPinPosition,l=e.pinPxRadius,d=e.pinColor,p=e.onMouseDown,v=Object(i.useContext)(g).theme,h=void 0;(null===(t=null===v||void 0===v?void 0:v.node)||void 0===t?void 0:t.customPins)&&(null===(n=null===v||void 0===v?void 0:v.node)||void 0===n?void 0:n.customPins[u])&&(h=null===(o=null===v||void 0===v?void 0:v.node)||void 0===o?void 0:o.customPins[u]);var f=te(te({position:"absolute",width:"".concat(2*l,"px"),height:"".concat(2*l,"px"),left:"".concat(s,"px"),top:"calc(50% - ".concat(l,"px)")},null===(a=null===v||void 0===v?void 0:v.node)||void 0===a?void 0:a.basePin),h);return d&&(f.backgroundColor=d),r.a.createElement("div",{className:c,style:f,onMouseDown:p})},oe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ae=function(e){function t(t){var n=e.call(this,t)||this;return n.dragWrapper=new ee,n.connectorRef=r.a.createRef(),n.leftPinPos=null,n.rightPinPos=null,n.pinPxRadius=6,n.onMouseDown=n.onMouseDown.bind(n),n.onPinPositionUpdate=n.onPinPositionUpdate.bind(n),n}return oe(t,e),t.prototype.componentDidMount=function(){this.onPinPositionUpdate()},t.prototype.componentDidUpdate=function(){this.onPinPositionUpdate()},t.prototype.onPinPositionUpdate=function(){var e=this.props,t=e.cId,n=e.onPinPositionUpdate,a=this.getConnectorPinPosition(o.LEFT),i=this.getConnectorPinPosition(o.RIGHT);v.a.isEqual(a,this.leftPinPos)&&v.a.isEqual(i,this.rightPinPos)||(this.leftPinPos=a,this.leftPinPos=i,n(t,a,i))},t.prototype.onMouseDown=function(e,t){var n=this.props,a=n.nodeId,i=n.cId,r=n.getZoom,c=n.onUpdatePreviewLink,u=n.onCreateLink,s=this.getConnectorPinPosition(e);if(s&&c&&u){this.dragWrapper.onMouseDown(t,s,r,(function(e,t){c({linkId:"preview",outputPinPosition:t,inputPinPosition:e})}),(function(e,t,n){var r=null;n.target&&("string"===typeof n.target.className&&(r=n.target.className.match(/node-(.+)-connector-(.+)-(left|right)/)));null!==r&&"left"===r[3]?u({inputNodeId:r[1],inputPinId:r[2],inputPinSide:o.LEFT,outputNodeId:a,outputPinId:i,outputPinSide:o.RIGHT}):null!==r&&u({inputNodeId:a,inputPinId:i,inputPinSide:o.LEFT,outputNodeId:r[1],outputPinId:r[2],outputPinSide:o.RIGHT,linkType:"bezier"}),c(void 0)}))}},t.prototype.getConnectorPinPosition=function(e){var t=this.props,n=t.connector,i=t.node,r=this.connectorRef.current;return!r||n.pinLayout===a.NO_PINS||e===o.LEFT&&n.pinLayout===a.RIGHT_PIN||e===o.RIGHT&&n.pinLayout===a.LEFT_PIN?null:{x:e===o.RIGHT?i.width+i.position.x:i.position.x,y:i.position.y+r.offsetTop+r.offsetHeight/2}},t.prototype.render=function(){var e=this,t=this.props,n=t.connector,i=t.node,c=t.nodeId,u=t.cId,s=t.createCustomConnectorComponent,l=null;return s&&(l=s(this.props)),l||(l=function(e){var t=e.connector;return"string"===t.contentType?r.a.createElement(K,Q({},e)):"text_area"===t.contentType?r.a.createElement(q,Q({},e)):"number"===t.contentType?r.a.createElement(D,Q({},e)):"check_box"===t.contentType?r.a.createElement(U,Q({},e)):"select"===t.contentType?r.a.createElement(Z,Q({},e)):"button"===t.contentType?r.a.createElement(G,Q({},e)):r.a.createElement(R,Q({},e))}(this.props)),r.a.createElement("div",{className:"node-background",ref:this.connectorRef,style:{position:"relative",paddingTop:3}},[a.LEFT_PIN,a.BOTH_PINS].includes(n.pinLayout)&&r.a.createElement(ne,{className:"node-".concat(c,"-connector-").concat(u,"-left"),contentType:n.contentType,pinPxRadius:this.pinPxRadius,leftPinPosition:-this.pinPxRadius,onMouseDown:function(t){return e.onMouseDown(o.LEFT,t)},pinColor:this.props.connector.leftPinColor}),[a.RIGHT_PIN,a.BOTH_PINS].includes(n.pinLayout)&&r.a.createElement(ne,{className:"node-".concat(c,"-connector-").concat(u,"-right"),contentType:n.contentType,pinPxRadius:this.pinPxRadius,leftPinPosition:i.width-this.pinPxRadius,onMouseDown:function(t){return e.onMouseDown(o.RIGHT,t)},pinColor:this.props.connector.rightPinColor}),r.a.createElement("div",{className:"node-background",style:{overflow:"hidden",paddingLeft:2*this.pinPxRadius,paddingRight:2*this.pinPxRadius}},l))},t}(i.Component),ie=function(){return ie=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},ie.apply(this,arguments)};function re(e){var t,n,o=e.node,a=Object(i.useContext)(g).theme;return r.a.createElement("div",{className:"node-background node-header",style:ie(ie({},null===(t=a.node)||void 0===t?void 0:t.header),null===(n=o.theme)||void 0===n?void 0:n.header)},o.name)}var ce=function(){return ce=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},ce.apply(this,arguments)};function ue(e){var t,n,o=e.node,a=Object(i.useContext)(g).theme;return r.a.createElement("div",{className:"node-background node-footer",style:ce(ce({},null===(t=null===a||void 0===a?void 0:a.node)||void 0===t?void 0:t.footer),null===(n=null===o||void 0===o?void 0:o.theme)||void 0===n?void 0:n.footer)})}var se=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),le=function(){return le=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},le.apply(this,arguments)},de=function(e){function t(t){var n=e.call(this,t)||this;return n.dragWrapper=new ee,n.pinPositions={},n.onMouseDown=n.onMouseDown.bind(n),n.onPinPositionUpdate=n.onPinPositionUpdate.bind(n),n}return se(t,e),t.prototype.shouldComponentUpdate=function(e){var t=this.props,n=t.node;return t.isNodeSelected!==e.isNodeSelected||!v.a.isEqual(n,e.node)},t.prototype.onMouseDown=function(e){var t=this.props,n=t.nodeId,o=t.getZoom,a=t.onNodeMoveStart,i=t.onNodeMove,r=t.onNodeMoveEnd;if(a&&i&&r){var c=!0,u="";if(e.target){var s=e.target.className;"string"===typeof s&&s.includes("node-background")&&(u=s,c=!1)}if(!c){a(n,e.shiftKey);var l=o(),d={x:e.pageX/l,y:e.pageY/l};this.dragWrapper.onMouseDown(e,d,o,(function(e,t,n){u.includes("node-footer")?i(0,0,n.x):i(n.x,n.y,0)}),(function(e,t,o){r(n,!h(e,t),o.shiftKey)}))}}},t.prototype.onPinPositionUpdate=function(e,t,n){var o=this.props,i=o.nodeId,r=o.node,c=o.onNodePinPositionsUpdate;this.pinPositions[e]=[t,n];var u=Object.keys(r.connectors).filter((function(e){return r.connectors[e].pinLayout!==a.NO_PINS})).length;Object.keys(this.pinPositions).length===u&&c(i,this.pinPositions)},t.prototype.render=function(){var e,t,n,o,a,i,c=this,u=this.context.theme,s=this.props,l=s.nodeId,d=s.node,p=s.isNodeSelected,v=this.props,h=v.onCreateLink,f=v.onUpdatePreviewLink,m=v.getZoom,y=v.onConnectorUpdate,b=this.props.createCustomConnectorComponent,O={position:"absolute",width:"".concat(d.width,"px"),top:"".concat(d.position.y,"px"),left:"".concat(d.position.x,"px")},g=p?le(le({},null===(e=null===u||void 0===u?void 0:u.node)||void 0===e?void 0:e.selected),null===(t=null===d||void 0===d?void 0:d.theme)||void 0===t?void 0:t.selected):le(le({},null===(n=null===u||void 0===u?void 0:u.node)||void 0===n?void 0:n.unselected),null===(o=null===d||void 0===d?void 0:d.theme)||void 0===o?void 0:o.unselected);return r.a.createElement("div",{className:"node-background",style:le(le({},O),g),onMouseDown:this.onMouseDown,id:"node_".concat(l)},r.a.createElement(re,{node:d}),r.a.createElement("div",{style:le(le({},null===(a=null===u||void 0===u?void 0:u.node)||void 0===a?void 0:a.body),null===(i=null===d||void 0===d?void 0:d.theme)||void 0===i?void 0:i.body)},Object.keys(d.connectors).map((function(e){return r.a.createElement(ae,{nodeId:l,cId:e,getZoom:m,node:d,key:e,connector:d.connectors[e],onCreateLink:h,onUpdatePreviewLink:f,onConnectorUpdate:y,onPinPositionUpdate:c.onPinPositionUpdate,createCustomConnectorComponent:b})}))),r.a.createElement(ue,{node:d}))},t}(i.Component);de.contextType=g;var pe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ve=function(e){function t(t){var n=e.call(this,t)||this;return n.onNodeMoveStart=n.onNodeMoveStart.bind(n),n.onNodeMove=n.onNodeMove.bind(n),n.onNodeMoveEnd=n.onNodeMoveEnd.bind(n),n}return pe(t,e),t.prototype.onNodeMoveStart=function(e,t){var n=this,o=this.props,a=o.selectedItems,i=o.onSelectItem,r={id:e,type:"node"},c=!1;a.forEach((function(e){e.id===r.id&&e.type===r.type&&(c=!0)})),c||(this.lastSettedSelection=r,a.forEach((function(t){t.id===e&&"node"===t.type&&(n.lastSettedSelection=void 0)})),t&&this.lastSettedSelection&&i(r,t),t||i(r,t))},t.prototype.onNodeMove=function(e,t,n){var o=this;this.props.selectedItems.forEach((function(a){if("node"===a.type){var i=o.props,r=i.nodes,c=i.onNodeMove,u=r[a.id].position.x+e,s=r[a.id].position.y+t,l=r[a.id].width+n;c(a.id,u,s,l>100?l:100)}}))},t.prototype.onNodeMoveEnd=function(e,t,n){var o=this.props.onSelectItem,a={id:e,type:"node"};(t||n)&&(t||!n||v.a.isEqual(a,this.lastSettedSelection))||o(a,n),this.lastSettedSelection=void 0},t.prototype.render=function(){var e=this,t=this.props,n=t.nodes,o=t.selectedItems,a=this.props,i=a.getZoom,c=a.onCreateLink,u=a.onUpdatePreviewLink,s=a.onNodePinPositionsUpdate,l=this.props,d=l.onConnectorUpdate,p=l.createCustomConnectorComponent;return r.a.createElement(r.a.Fragment,null,Object.keys(n).map((function(t){return r.a.createElement(de,{nodeId:t,key:t,node:n[t],isNodeSelected:v.a.some(o,{id:t,type:"node"}),getZoom:i,onNodeMoveStart:e.onNodeMoveStart,onNodeMove:e.onNodeMove,onNodeMoveEnd:e.onNodeMoveEnd,onCreateLink:c,onUpdatePreviewLink:u,onNodePinPositionsUpdate:s,onConnectorUpdate:d,createCustomConnectorComponent:p})})))},t}(r.a.Component),he=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),fe=function(e,t,n){if(n||2===arguments.length)for(var o,a=0,i=t.length;a<i;a++)!o&&a in t||(o||(o=Array.prototype.slice.call(t,0,a)),o[a]=t[a]);return e.concat(o||Array.prototype.slice.call(t))};Object(d.b)();var me,ye=function(e){function t(t){var n=e.call(this,t)||this;return n.nodesPinPositions={},n.mainDivRef=r.a.createRef(),n.state={linksPositions:{}},n.getZoom=n.getZoom.bind(n),n.onUpdatePreviewLink=n.onUpdatePreviewLink.bind(n),n.onNodePinPositionsUpdate=n.onNodePinPositionsUpdate.bind(n),n.onSelectItem=n.onSelectItem.bind(n),n.onCreateLink=n.onCreateLink.bind(n),n.onConnectorUpdate=n.onConnectorUpdate.bind(n),n.onNodeMove=n.onNodeMove.bind(n),n.filterRenderedNodes=n.filterRenderedNodes.bind(n),n.filterRenderedLinks=n.filterRenderedLinks.bind(n),n}return he(t,e),t.prototype.componentDidMount=function(){this.updateLinkPositions()},t.prototype.componentDidUpdate=function(){this.updateLinkPositions()},t.prototype.onSelectItem=function(e,t){var n=this.props,o=n.selectedItems,a=n.onSelectedItems;if(e||t){if(e&&t&&v.a.some(o,e)){var i=fe([],o,!0),r=-1;o.forEach((function(t,n){t.id===e.id&&t.type===e.type&&(r=n)})),-1!==r&&i.splice(r,1),a(i)}else if(e&&!v.a.some(o,e)){i=fe([],o,!0);t||(i=[]),i.push(e),a(i)}}else a([]);!t&&e&&a([e])},t.prototype.onUpdatePreviewLink=function(e){this.setState({draggedLink:e})},t.prototype.onNodePinPositionsUpdate=function(e,t){this.nodesPinPositions[e]=t},t.prototype.onCreateLink=function(e){var t=this.props.onCreateLink;t&&e.inputPinSide!==e.outputPinSide&&e.inputNodeId!==e.outputNodeId&&t(e)},t.prototype.onNodeMove=function(e,t,n,o){var a=this.props.onNodeMove;a&&a(e,t,n,o)},t.prototype.onConnectorUpdate=function(e,t,n){var o=this.props.onConnectorUpdate;o&&o(e,t,n)},t.prototype.getZoom=function(){return this.props.panZoomInfo.zoom},t.prototype.updateLinkPositions=function(){var e=this,t=this.props.links,n=this.state.linksPositions,a=!1,i=Object(d.c)(n,(function(i){Object.keys(t).forEach((function(n){var r=t[n];if(r.inputNodeId in e.nodesPinPositions!==!1&&r.outputNodeId in e.nodesPinPositions!==!1){var c=e.nodesPinPositions[r.inputNodeId][r.inputPinId],u=e.nodesPinPositions[r.outputNodeId][r.outputPinId];if(c&&u){var s=c[r.inputPinSide===o.LEFT?0:1],l=u[r.outputPinSide===o.LEFT?0:1];s&&l&&(n in i&&h(i[n].inputPinPosition,s)&&h(i[n].outputPinPosition,l)||(i[n]={linkId:n,inputPinPosition:s,outputPinPosition:l},a=!0))}}})),Object.keys(n).forEach((function(e){e in t||(delete i[e],a=!0)}))}));a&&this.setState({linksPositions:i})},t.prototype.filterRenderedNodes=function(){var e=this.props,t=e.nodes,n=e.panZoomInfo,o=this.mainDivRef.current;if(!o)return t;var a=-n.topLeftCorner.x/n.zoom-50,i=-n.topLeftCorner.y/n.zoom-50,r=a+o.offsetWidth/n.zoom+100,c=i+o.offsetHeight/n.zoom+100,u={},s=function(e,t,n){return e>=t&&e<=n};return Object.keys(t).forEach((function(e){var n=t[e],o=s(a,n.position.x,n.position.x+n.width)||s(n.position.x,a,r),l=s(i,n.position.y,n.position.y+1e3)||s(n.position.y,i,c);o&&l&&(u[e]=n)})),u},t.prototype.filterRenderedLinks=function(e){var t=this.props.links,n={};return Object.keys(t).forEach((function(o){var a=t[o];(e.includes(a.inputNodeId)||e.includes(a.outputNodeId))&&(n[o]=a)})),n},t.prototype.render=function(){var e=this.props,t=e.selectedItems,n=e.panZoomInfo,o=e.theme,a=this.props,i=a.onPanZoomInfo,c=a.createCustomConnectorComponent,u=this.state,s=u.draggedLink,l=u.linksPositions,d=this.filterRenderedNodes(),p=this.filterRenderedLinks(Object.keys(d));return r.a.createElement(g.Provider,{value:o||O},r.a.createElement("div",{style:{width:"100%",height:"100%"},ref:this.mainDivRef},r.a.createElement(j,{panZoomInfo:n},r.a.createElement(b,{panZoomInfo:n,onPanZoomInfo:i,onSelectItem:this.onSelectItem},r.a.createElement(S,{links:p,linksPositions:l,draggedLink:s,selectedItems:t,onSelectItem:this.onSelectItem}),r.a.createElement(ve,{nodes:d,getZoom:this.getZoom,onNodeMove:this.onNodeMove,onCreateLink:this.onCreateLink,onUpdatePreviewLink:this.onUpdatePreviewLink,onConnectorUpdate:this.onConnectorUpdate,onNodePinPositionsUpdate:this.onNodePinPositionsUpdate,selectedItems:t,onSelectItem:this.onSelectItem,createCustomConnectorComponent:c})))))},t}(i.Component),be=function(e){var t=e.name,n=e.onClick,o=e.onMouseEnter,a=e.onMouseLeave;return r.a.createElement("div",{onClick:n,onMouseEnter:o,onMouseLeave:a},t)},Oe=function(e){var t=e.items;return r.a.createElement("div",{style:{flex:1,overflowY:"scroll"}},r.a.createElement("div",{style:{height:"460px"}},Object.keys(t).map((function(e){var n=t[e];return r.a.createElement(be,{name:n.name,onClick:n.onClick,onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave,key:e})}))))},ge=function(e){var t=e.menuTitle,n=e.items,o=r.a.useState(""),a=o[0],i=o[1],c=r.a.useCallback((function(e){i(e.currentTarget.value)}),[a]),u=Object(d.a)(n,(function(e){Object.keys(n).forEach((function(t){var o=n[t].name.toLowerCase(),i=a.toLowerCase();""===a||o.includes(i)||delete e[t]}))}));return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",overflow:"auto"}},t,r.a.createElement("br",null),r.a.createElement("input",{value:a,onChange:c,placeholder:"Filter options"}),r.a.createElement(Oe,{items:u}))},ke=function(){return ke=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},ke.apply(this,arguments)},je=function(e){var t=e.node,n=e.createCustomConnectorComponent,o=r.a.useRef(null),a=null;if(t&&o&&o.current){var i=o.current.getBoundingClientRect(),c=ke({},t);c.position={x:10,y:10},c.width=i.width-20,a=t?r.a.createElement(de,{nodeId:"0",getZoom:function(){return 1},isNodeSelected:!0,node:c,onConnectorUpdate:function(){return null},onNodePinPositionsUpdate:function(){return null},createCustomConnectorComponent:n}):null}return r.a.createElement("div",{ref:o,style:{position:"relative",gridArea:"preview",overflow:"hidden",width:"500px",height:"500px"}},a)},Pe=function(e){var t=e.nodesSchema,n=e.onNodeSelection,o=e.createCustomConnectorComponent,a=e.onMouseHover,i=r.a.useState(""),c=i[0],u=i[1],s={};Object.keys(t).forEach((function(e){s[e]={name:t[e].name,onMouseEnter:function(){u(e)},onMouseLeave:function(){u("")},onClick:function(){n(e)}}}));var l=r.a.useCallback((function(){a(!0)}),[a]),d=r.a.useCallback((function(){a(!1)}),[a]);return r.a.createElement("div",{style:{display:"flex"},onMouseLeave:d,onMouseEnter:l},r.a.createElement("div",null,r.a.createElement(ge,{menuTitle:"Add a new node",items:s})),r.a.createElement(je,{node:c?t[c]:null,createCustomConnectorComponent:o}))},xe=function(e){var t=e.onMouseHover,n=e.onDeleteSelection,o={};o.delete_selection={name:"Delete selection",onClick:function(){n()}};var a=r.a.useCallback((function(){t(!0)}),[t]),i=r.a.useCallback((function(){t(!1)}),[t]);return r.a.createElement("div",{onMouseLeave:i,onMouseEnter:a},r.a.createElement(ge,{menuTitle:"Selection management",items:o}))},Ie=n(0),Ne=n(1);function Ce(e,t){var n={};return Object.keys(t).forEach((function(o){t[o].outputNodeId===e&&(n[o]=t[o])})),n}function we(e,t){var n={};return Object.keys(t).forEach((function(o){t[o].inputNodeId===e&&(n[o]=t[o])})),n}function Ee(e){var t=[];return Object.keys(e).forEach((function(n){return t.push([n,e[n]])})),t.sort((function(e,t){return e[1]-t[1]})),t.map((function(e){var t=Object(s.a)(e,2),n=t[0];t[1];return n}))}function Te(e,t,n,o){o[e]=e in o?Math.max(n,o[e]):n;var a=Ce(e,t);Object.keys(a).forEach((function(e){Te(t[e].inputNodeId,t,n+1,o)}))}!function(e){e.Canvas="canvas",e.Color="color",e.Number="number",e.Rectangle="rectangle",e.Rotate="rotate",e.Timer="timer",e.Translate="translate",e.IfElse="if-else",e.String="string",e.Split="split",e.Operation="operation",e.Log="log",e.Arc="arc",e.Check="check",e.Boolean="boolean",e.FunctionInputNode="function-inputs",e.FunctionOutputNode="function-outputs",e.FunctionCallNode="function-call",e.ThreeJS="threejs",e.ThreeJSBox="threejs-box",e.Range="range",e.Map="map",e.TextArea="text-area",e.Pop="pop",e.Length="length",e.Shift="shift",e.ObjectCreatorNode="object-creator",e.ObjectExtractorNode="object-extractor",e.LambdaCall="lambda-call"}(me||(me={}));var _e=function(){function e(){Object(Ie.a)(this,e),this.tasks=[],this.propagationValues={},this.functionCalls=[],this.functionResults=[]}return Object(Ne.a)(e,[{key:"reset",value:function(){this.tasks=[],this.propagationValues={},this.functionCalls=[],this.functionResults=[]}},{key:"popResult",value:function(){return this.functionResults.pop()}},{key:"propateFunction",value:function(e,t,n){var o=Object.keys(t).find((function(n){var o=t[n];return o.outputNodeId===e&&"0"===o.outputPinId}));if(o){var a=t[o].inputNodeId;this.functionCalls.unshift({functionOutId:a,inputs:n,propagationValues:{},alreadyComputedNodes:[],toBeComputed:[[a,!1]]})}else console.log("no node id")}},{key:"propagateAll",value:function(e,t){var n=this,o={};Object.keys(e).forEach((function(e){Te(e,t,0,o)})),Ee(o).forEach((function(e){return n.tasks.push([e,!1])}))}},{key:"propagateNode",value:function(e,t,n){var o=this,a={};Te(e,n,0,a);var i=Ee(a),r="";if(i.forEach((function(e){t[e].name===me.FunctionOutputNode&&(r=e)})),""!==r){var c=we(r,n),u="";Object.keys(c).forEach((function(e){"0"===n[e].inputPinId&&(u=n[e].outputNodeId)}));var s=t[u];if(s&&s.name===me.FunctionInputNode){var l=s.connectors[0].data.value,d=[];Object.keys(t).forEach((function(e){t[e].name===me.FunctionCallNode&&t[e].connectors[0].data.value===l&&d.push(e),t[e].name===me.Map&&t[e].connectors[2].data.value===l&&d.push(e),t[e].name===me.LambdaCall&&t[e].connectors[0].data.value===l&&d.push(e)})),d.forEach((function(e){return o.propagateNode(e,t,n)}))}}else i.forEach((function(e){return o.tasks.push([e,!1])}))}},{key:"runAll",value:function(e,t,n){for(;this.functionCalls.length>0||this.tasks.length>0;)this.functionCalls.length>0?this.runFunctionTask(e,t,n):this.runTask(e,t,n)}},{key:"runFunctionTask",value:function(e,t,n){var o=this.functionCalls[0],a=o.toBeComputed[0][0];if(a){var i=e[a],r=we(a,t),c=Object.keys(r).map((function(e){return t[e].outputNodeId})),u=!0;if(i.name===me.IfElse?Object.keys(r).forEach((function(e){if("1"===t[e].inputPinId)if(e in o.propagationValues){var n=o.propagationValues[e];Object.keys(r).forEach((function(e){if("2"===t[e].inputPinId&&n||"3"===t[e].inputPinId&&!n){var a=t[e].outputNodeId;o.alreadyComputedNodes.includes(a)||(u=!1,o.toBeComputed.unshift([a,!1]))}}))}else u=!1,o.toBeComputed.unshift([t[e].outputNodeId,!1])})):c.forEach((function(e){o.alreadyComputedNodes.includes(e)||(u=!1,o.toBeComputed.unshift([e,!1]))})),u){var s=we(a,t),l={};if(Object.keys(s).forEach((function(e){if(e in o.propagationValues){var n=t[e].inputPinId;n in i.connectors&&(i.connectors[n].isMultiInputAllowed?(n in l||(l[n]=[]),l[n].push(o.propagationValues[e])):l[n]=o.propagationValues[e])}})),!o.toBeComputed[0][1]&&(o.toBeComputed[0][1]=i.registerfunctionRun(l,a,n,e,t,this),o.toBeComputed[0][1]))return;var d=i.computeSpecific(i.name===me.FunctionInputNode?o.inputs:l,a,n,e,t,this),p=Ce(a,t);Object.keys(p).forEach((function(e){o.propagationValues[e]=d[t[e].outputPinId]})),o.alreadyComputedNodes.push(a),o.toBeComputed.shift()}if(0===o.toBeComputed.length){var v=Object.keys(t).find((function(e){var n=t[e];return n.inputNodeId===o.functionOutId&&"1"===n.inputPinId}));v&&v in o.propagationValues?(this.functionResults.push(o.propagationValues[v]),this.functionCalls.shift()):(this.functionResults.push(void 0),this.functionCalls.shift())}}}},{key:"runTask",value:function(e,t,n){var o=this,a=this.tasks[0];if(a){var i=e[a[0]],r=we(a[0],t),c={};if(Object.keys(r).forEach((function(e){if(e in o.propagationValues){var n=t[e].inputPinId;i.connectors[n]&&i.connectors[n].isMultiInputAllowed?(n in c||(c[n]=[]),c[n].push(o.propagationValues[e])):i.connectors[n]&&(c[n]=o.propagationValues[e])}})),!a[1]&&(this.tasks[0][1]=i.registerfunctionRun(c,a[0],n,e,t,this),this.tasks[0][1]))return;var u=i.computeSpecific(c,a[0],n,e,t,this),s=Ce(a[0],t);Object.keys(s).forEach((function(e){o.propagationValues[e]=u[t[e].outputPinId]})),this.tasks.shift()}}}]),e}(),Le=function(){function e(t,n,o,a){Object(Ie.a)(this,e),this[l.b]=!0,this.name=void 0,this.position=void 0,this.width=void 0,this.connectors=void 0,this.name=t,this.width=n,this.position=o,this.connectors=a}return Object(Ne.a)(e,[{key:"registerfunctionRun",value:function(e,t,n,o,a,i){return!1}}],[{key:"initFromJson",value:function(e,t){t.name=e.name,t.width=e.width,t.position=e.position,t.connectors=e.connectors}}]),e}(),Se=n(2),Fe=n(3),Me=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Canvas,430,{x:0,y:0},{0:{name:"draw",pinLayout:a.LEFT_PIN,contentType:"canvas",data:{canvas_width:400,canvas_height:400,canvas_color:"white"},isMultiInputAllowed:!0},1:{name:"width",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:400}},2:{name:"height",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:400}},3:{name:"color",pinLayout:a.LEFT_PIN,contentType:"none",data:{value:"white"},leftPinColor:"orange"}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e,t,n){var o=Number("1"in e?e[1]:this.connectors[1].data.value),a=Number("2"in e?e[2]:this.connectors[2].data.value),i="3"in e?e[3]:this.connectors[3].data.value,r=function(t){t.clearRect(0,0,t.canvas.width,t.canvas.height),e[0]&&e[0].forEach((function(e){Array.isArray(e)?e.forEach((function(e){return e(t)})):e(t)}))};return n((function(n){return Object(l.a)(n,(function(n){n[t].connectors[0].data.canvas_width=Number(o),n[t].connectors[0].data.canvas_height=Number(a),n[t].connectors[0].data.canvas_color=i,n[t].connectors[0].data.canvas_draw=r,n[t].connectors[1].data.disabled="1"in e,n[t].connectors[1].data.value=o,n[t].connectors[2].data.disabled="2"in e,n[t].connectors[2].data.value=a}))})),{}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),Re=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Rectangle,200,{x:0,y:0},{0:{name:"draw",pinLayout:a.RIGHT_PIN,contentType:"none",data:{}},1:{name:"x",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},2:{name:"y",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},3:{name:"width",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:100,disabled:!1}},4:{name:"height",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:100,disabled:!1}},5:{name:"color",pinLayout:a.LEFT_PIN,contentType:"none",data:{value:"black"},leftPinColor:"orange"},6:{name:"type",pinLayout:a.NO_PINS,contentType:"select",data:{values:["fill","stroke","clear"],selected_index:0}},7:{name:"line width",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:1,disabled:!1}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e,t,n){var o="1"in e?e[1]:this.connectors[1].data.value,a="2"in e?e[2]:this.connectors[2].data.value,i="3"in e?e[3]:this.connectors[3].data.value,r="4"in e?e[4]:this.connectors[4].data.value,c="5"in e?e[5]:this.connectors[5].data.value,u="7"in e?e[7]:this.connectors[7].data.value;n((function(n){return Object(l.a)(n,(function(n){n[t].connectors[1].data.disabled="1"in e,n[t].connectors[1].data.value=o,n[t].connectors[2].data.disabled="2"in e,n[t].connectors[2].data.value=a,n[t].connectors[3].data.disabled="3"in e,n[t].connectors[3].data.value=i,n[t].connectors[4].data.disabled="4"in e,n[t].connectors[4].data.value=r,n[t].connectors[7].data.disabled="7"in e,n[t].connectors[7].data.value=u}))}));var s=this.connectors[6].data.selected_index;return{0:function(e){if(0===s)e.fillStyle=c,e.fillRect(o,a,i,r),e.fillStyle="black";else if(1===s){e.strokeStyle=c;var t=e.lineWidth;e.lineWidth=u,e.strokeRect(o,a,i,r),e.lineWidth=t,e.strokeStyle="black"}else 2===s&&e.clearRect(o,a,i,r)}}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),Je=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Rotate,150,{x:0,y:0},{0:{name:"draw",pinLayout:a.BOTH_PINS,contentType:"none",data:{}},1:{name:"angle",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e,t,n){var o="1"in e?e[1]:this.connectors[1].data.value;o=o*Math.PI/180,n((function(n){return Object(l.a)(n,(function(n){n[t].connectors[1].data.disabled="1"in e,n[t].connectors[1].data.value=o}))}));return{0:function(t){t.rotate(o),e[0]&&e[0].forEach((function(e){e(t)})),t.rotate(-o)}}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),ze=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Number,170,{x:0,y:0},{0:{name:"number",pinLayout:a.RIGHT_PIN,contentType:"number",data:{value:0}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(){return{0:Number(this.connectors[0].data.value)}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),Ue=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Color,150,{x:0,y:0},{0:{name:"color",pinLayout:a.RIGHT_PIN,contentType:"canvas",data:{canvas_width:120,canvas_height:40,canvas_color:"black"},rightPinColor:"orange"},1:{name:"red",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0}},2:{name:"green",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0}},3:{name:"blue",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0}},4:{name:"alpha",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:1}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e,t,n){var o=this,a="1"in e?e[1]:this.connectors[1].data.value,i="2"in e?e[2]:this.connectors[2].data.value,r="3"in e?e[3]:this.connectors[3].data.value,c="4"in e?e[4]:this.connectors[4].data.value;i=i>255?255:i<0?0:i,r=r>255?255:r<0?0:r,c=c>1?1:c<0?0:c;var u="rgba(".concat(a=a>255?255:a<0?0:a,", ").concat(i,", ").concat(r,", ").concat(c,")");return n((function(n){return Object(l.a)(n,(function(n){n[t].connectors[0].data.canvas_width=o.width-30,n[t].connectors[0].data.canvas_color=u,n[t].connectors[1].data.disabled="1"in e,n[t].connectors[1].data.value=a,n[t].connectors[2].data.disabled="2"in e,n[t].connectors[2].data.value=i,n[t].connectors[3].data.disabled="3"in e,n[t].connectors[3].data.value=r,n[t].connectors[4].data.disabled="4"in e,n[t].connectors[4].data.value=c}))})),{0:u}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),He=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Timer,150,{x:0,y:0},{0:{name:"count",pinLayout:a.RIGHT_PIN,contentType:"number",data:{value:"0"}},1:{name:"is_running",pinLayout:a.NO_PINS,contentType:"check_box",data:{value:!1}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e){return{0:this.connectors[0].data.value}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),Ae=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Translate,100,{x:0,y:0},{0:{name:"draw",pinLayout:a.BOTH_PINS,contentType:"none",data:{}},1:{name:"x",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0}},2:{name:"y",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e,t,n){var o="1"in e?e[1]:this.connectors[1].data.value,a="2"in e?e[2]:this.connectors[2].data.value;n((function(n){return Object(l.a)(n,(function(n){n[t].connectors[1].data.disabled="1"in e,n[t].connectors[1].data.value=o,n[t].connectors[2].data.disabled="2"in e,n[t].connectors[2].data.value=a}))}));return{0:function(t){t.translate(o,a),e[0]&&e[0].forEach((function(e){e(t)})),t.translate(-o,-a)}}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),De=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.IfElse,100,{x:0,y:0},{0:{name:"out_value",pinLayout:a.RIGHT_PIN,contentType:"none",data:{}},1:{name:"test",pinLayout:a.LEFT_PIN,contentType:"check_box",data:{value:!1}},2:{name:"if_value",pinLayout:a.LEFT_PIN,contentType:"none",data:{}},3:{name:"else_value",pinLayout:a.LEFT_PIN,contentType:"none",data:{}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e,t,n){var o="1"in e?e[1]:this.connectors[1].data.value,a="2"in e?e[2]:null,i={0:"3"in e?e[3]:null};return o&&(i={0:a}),n((function(n){return Object(l.a)(n,(function(n){n[t].connectors[1].data.disabled="1"in e,n[t].connectors[1].data.value=o}))})),i}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),Ze=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.String,100,{x:0,y:0},{0:{name:"string",pinLayout:a.RIGHT_PIN,contentType:"string",data:{value:""}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(){return{0:this.connectors[0].data.value}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),Ge=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Split,100,{x:0,y:0},{0:{name:"out",pinLayout:a.RIGHT_PIN,contentType:"none",data:{}},1:{name:"input",pinLayout:a.LEFT_PIN,contentType:"text_area",data:{value:""}},2:{name:"separator",pinLayout:a.LEFT_PIN,contentType:"string",data:{value:"",height:"20px"}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e){var t="1"in e?e[1]:this.connectors[1].data.value,n="2"in e?e[2]:this.connectors[2].data.value;return n=n||"",{0:(t=t||"").split(new RegExp(n))}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),Be=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Operation,160,{x:0,y:0},{0:{name:"output",pinLayout:a.RIGHT_PIN,contentType:"number",data:{value:0,disabled:!0}},1:{name:"type",pinLayout:a.NO_PINS,contentType:"select",data:{values:["add","substract","multiply","divide","modulo","minimum","maximum","exp","log","log10","negate","sin","cos","tan"],selected_index:0}},2:{name:"x",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},3:{name:"y",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e,t,n){var o=Number("2"in e?e[2]:this.connectors[2].data.value),a=Number("3"in e?e[3]:this.connectors[3].data.value),i=0;switch(this.connectors[1].data.selected_index){case 0:i=o+a;break;case 1:i=o-a;break;case 2:i=o*a;break;case 3:i=isNaN(o/a)?0:o/a;break;case 4:i=isNaN(o%a)?0:o%a;break;case 5:i=o>a?a:o;break;case 6:i=o>a?o:a;break;case 7:i=Math.pow(o,a);break;case 8:i=Math.log(o);break;case 9:i=Math.log10(o);break;case 10:i=-o;break;case 11:i=Math.sin(o);break;case 12:i=Math.cos(o);break;case 13:i=Math.tan(o)}return n((function(n){return Object(l.a)(n,(function(n){n[t].connectors[0].data.value=i,n[t].connectors[2].data.disabled="2"in e,n[t].connectors[2].data.value=o,n[t].connectors[3].data.disabled="3"in e,n[t].connectors[3].data.value=a}))})),{0:i}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),Ve=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){var e;return Object(Ie.a)(this,n),(e=t.call(this,me.Log,100,{x:0,y:0},{0:{name:"log",pinLayout:a.LEFT_PIN,contentType:"text_area",data:{value:"",disabled:!0},leftPinColor:"red"}})).inputs=void 0,e}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e,t,n){return n((function(n){return Object(l.a)(n,(function(n){n[t].connectors[0].data.value="0"in e?JSON.stringify(e[0]):""}))})),{}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),We=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Arc,200,{x:0,y:0},{0:{name:"draw",pinLayout:a.RIGHT_PIN,contentType:"none",data:{}},1:{name:"x",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},2:{name:"y",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},3:{name:"radius",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:100,disabled:!1}},4:{name:"start angle",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},5:{name:"end angle",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:2*Math.PI,disabled:!1}},6:{name:"color",pinLayout:a.LEFT_PIN,contentType:"none",data:{value:"black"},leftPinColor:"orange"},7:{name:"type",pinLayout:a.NO_PINS,contentType:"select",data:{values:["fill","stroke"],selected_index:0}},8:{name:"line width",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:1,disabled:!1}},9:{name:"counterclockwise",pinLayout:a.LEFT_PIN,contentType:"check_box",data:{value:!1}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e,t,n){var o="1"in e?e[1]:this.connectors[1].data.value,a="2"in e?e[2]:this.connectors[2].data.value,i="3"in e?e[3]:this.connectors[3].data.value,r="4"in e?e[4]:this.connectors[4].data.value,c="5"in e?e[5]:this.connectors[5].data.value,u="6"in e?e[6]:this.connectors[6].data.value,s="8"in e?e[8]:this.connectors[8].data.value,d="9"in e?e[9]:this.connectors[9].data.value;n((function(n){return Object(l.a)(n,(function(n){n[t].connectors[1].data.disabled="1"in e,n[t].connectors[1].data.value=o,n[t].connectors[2].data.disabled="2"in e,n[t].connectors[2].data.value=a,n[t].connectors[3].data.disabled="3"in e,n[t].connectors[3].data.value=i,n[t].connectors[4].data.disabled="4"in e,n[t].connectors[4].data.value=r,n[t].connectors[5].data.disabled="5"in e,n[t].connectors[5].data.value=c,n[t].connectors[8].data.disabled="8"in e,n[t].connectors[8].data.value=s}))}));var p=this.connectors[7].data.selected_index;return{0:function(e){if(0===p)e.fillStyle=u,e.beginPath(),e.arc(o,a,i,r,c,d),e.closePath(),e.fill(),e.fillStyle="black";else if(1===p){e.strokeStyle=u;var t=e.lineWidth;e.lineWidth=s,e.beginPath(),e.arc(o,a,i,r,c,d),e.closePath(),e.stroke(),e.lineWidth=t,e.strokeStyle="black"}}}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),qe=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Check,160,{x:0,y:0},{0:{name:"output",pinLayout:a.RIGHT_PIN,contentType:"none",data:{value:!1,disabled:!0}},1:{name:"type",pinLayout:a.NO_PINS,contentType:"select",data:{values:["===","!==","<","<=",">",">="],selected_index:0}},2:{name:"x",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},3:{name:"y",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e,t,n){var o=Number("2"in e?e[2]:this.connectors[2].data.value),a=Number("3"in e?e[3]:this.connectors[3].data.value),i=!1;switch(this.connectors[1].data.selected_index){case 0:i=o===a;break;case 1:i=o!==a;break;case 2:i=o<a;break;case 3:i=o<=a;break;case 4:i=o>a;break;case 5:i=o>=a}return n((function(n){return Object(l.a)(n,(function(n){n[t].connectors[0].data.value=i,n[t].connectors[2].data.disabled="2"in e,n[t].connectors[2].data.value=o,n[t].connectors[3].data.disabled="3"in e,n[t].connectors[3].data.value=a}))})),{0:i}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),Ye=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Boolean,160,{x:0,y:0},{0:{name:"output",pinLayout:a.RIGHT_PIN,contentType:"none",data:{value:!1,disabled:!0}},1:{name:"type",pinLayout:a.NO_PINS,contentType:"select",data:{values:["===","!==","&&","||","!"],selected_index:0}},2:{name:"x",pinLayout:a.LEFT_PIN,contentType:"check_box",data:{value:!1}},3:{name:"y",pinLayout:a.LEFT_PIN,contentType:"check_box",data:{value:!1}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e,t,n){var o="2"in e?e[2]:this.connectors[2].data.value,a="3"in e?e[3]:this.connectors[3].data.value,i=!1;switch(this.connectors[1].data.selected_index){case 0:i=o===a;break;case 1:i=o!==a;break;case 2:i=o&&a;break;case 3:i=o||a;break;case 4:i=!o}return n((function(n){return Object(l.a)(n,(function(n){n[t].connectors[0].data.value=i,n[t].connectors[2].data.disabled="2"in e,n[t].connectors[2].data.value=o,n[t].connectors[3].data.disabled="3"in e,n[t].connectors[3].data.value=a}))})),{0:i}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),Xe=n(9),Ke=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.FunctionCallNode,150,{x:0,y:0},{0:{name:"function_name",pinLayout:a.NO_PINS,contentType:"string",data:{value:""}},1:{name:"output",pinLayout:a.RIGHT_PIN,contentType:"none",data:{}}})}return Object(Ne.a)(n,[{key:"registerfunctionRun",value:function(e,t,n,o,i,r){var c=this.connectors[0].data.value,u=[],s="";Object.keys(o).forEach((function(e){var t=o[e];t.name===me.FunctionInputNode&&t.connectors[0].data.value===c&&(s=e,Object.keys(t.connectors).forEach((function(e){Number(e)>2&&t&&u.push(t.connectors[e].name)})))})),n((function(e){return Object(l.a)(e,(function(e){t&&(Object.keys(e[t].connectors).forEach((function(n){Number(n)>1&&delete e[t].connectors[n]})),u.forEach((function(n,o){e[t].connectors[o+2]={name:n,pinLayout:a.LEFT_PIN,contentType:"none",data:{}}})))}))}));var d={};return u.forEach((function(t,n){n+2 in e&&(d["".concat(n+3)]=e["".concat(n+2)])})),s.length>0&&(r.propateFunction(s,i,d),!0)}},{key:"computeSpecific",value:function(e,t,n,o,a,i){var r=this.connectors[0].data.value,c=[],u="";Object.keys(o).forEach((function(e){var t=o[e];t.name===me.FunctionInputNode&&t.connectors[0].data.value===r&&(u=e,Object.keys(t.connectors).forEach((function(e){Number(e)>2&&t&&c.push(t.connectors[e].name)})))}));var s={};return c.forEach((function(t,n){n+2 in e&&(s["".concat(n+3)]=e["".concat(n+2)])})),u.length>0?{1:i.popResult()}:{}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),Qe=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){var e;return Object(Ie.a)(this,n),(e=t.call(this,me.FunctionInputNode,150,{x:0,y:0},{0:{name:"name",pinLayout:a.RIGHT_PIN,contentType:"string",data:{value:""}},1:{name:"add",pinLayout:a.NO_PINS,contentType:"button",data:{label:"add input"}},2:{name:"remove",pinLayout:a.NO_PINS,contentType:"button",data:{label:"remove input"}}})).nodeId=void 0,e.setNodes=void 0,e.add=e.add.bind(Object(Xe.a)(e)),e.remove=e.remove.bind(Object(Xe.a)(e)),e.connectors[1].data.onClick=e.add,e.connectors[2].data.onClick=e.remove,e}return Object(Ne.a)(n,[{key:"add",value:function(e){var t=this;this.nodeId&&this.setNodes&&this.setNodes((function(n){return Object(l.a)(n,(function(n){t.nodeId&&(n[t.nodeId].connectors[Object.keys(e.connectors).length]={name:"param-".concat(Object.keys(e.connectors).length-2),pinLayout:a.RIGHT_PIN,contentType:"string",data:{value:"param-".concat(Object.keys(e.connectors).length-2)}})}))}))}},{key:"remove",value:function(e){Object.keys(e.connectors).length}},{key:"computeSpecific",value:function(e,t,n){return e}}],[{key:"createFromJson",value:function(e,t,o){var a=new n;return Le.initFromJson(e,a),a.nodeId=t,a.setNodes=o,a.connectors[1].data.onClick=a.add.bind(a),a.connectors[2].data.onClick=a.remove.bind(a),a}}]),n}(Le),$e=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.FunctionOutputNode,150,{x:0,y:0},{0:{name:"function",pinLayout:a.LEFT_PIN,contentType:"none",data:{},rightPinColor:"orange"},1:{name:"return",pinLayout:a.LEFT_PIN,contentType:"none",data:{},rightPinColor:"orange"}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e,t,n){return{}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),et=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){var e;return Object(Ie.a)(this,n),(e=t.call(this,me.LambdaCall,150,{x:0,y:0},{0:{name:"name",pinLayout:a.BOTH_PINS,contentType:"string",data:{value:""}},1:{name:"add",pinLayout:a.NO_PINS,contentType:"button",data:{label:"add input"}},2:{name:"remove",pinLayout:a.NO_PINS,contentType:"button",data:{label:"remove input"}}})).nodeId=void 0,e.setNodes=void 0,e.add=e.add.bind(Object(Xe.a)(e)),e.remove=e.remove.bind(Object(Xe.a)(e)),e.connectors[1].data.onClick=e.add,e.connectors[2].data.onClick=e.remove,e}return Object(Ne.a)(n,[{key:"add",value:function(e){var t=this;this.nodeId&&this.setNodes&&this.setNodes((function(n){return Object(l.a)(n,(function(n){t.nodeId&&(n[t.nodeId].connectors[Object.keys(e.connectors).length]={name:"param-".concat(Object.keys(e.connectors).length-2),pinLayout:a.LEFT_PIN,contentType:"none",data:{value:"param-".concat(Object.keys(e.connectors).length-2)}})}))}))}},{key:"remove",value:function(e){Object.keys(e.connectors).length}},{key:"registerfunctionRun",value:function(e,t,n,o,a,i){var r="0"in e?e[0]:this.connectors[0].data.value,c="";Object.keys(o).forEach((function(e){var t=o[e];t.name===me.FunctionInputNode&&t.connectors[0].data.value===r&&(c=e)}));var u={};return Object.keys(this.connectors).forEach((function(t,n){if(!(n<=2)){var o=t in e?e[t]:void 0;u[t]=o}})),c.length>0&&(i.propateFunction(c,a,u),!0)}},{key:"computeSpecific",value:function(e,t,n,o,a,i){var r="",c="0"in e?e[0]:this.connectors[0].data.value;return Object.keys(o).forEach((function(e){var t=o[e];t.name===me.FunctionInputNode&&t.connectors[0].data.value===c&&(r=e)})),r.length>0?{0:i.popResult()}:{}}}],[{key:"createFromJson",value:function(e,t,o){var a=new n;return Le.initFromJson(e,a),a.nodeId=t,a.setNodes=o,a.connectors[1].data.onClick=a.add.bind(a),a.connectors[2].data.onClick=a.remove.bind(a),a}}]),n}(Le),tt=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.ThreeJS,170,{x:0,y:0},{0:{name:"threejs",pinLayout:a.LEFT_PIN,contentType:"threejs",data:{}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e,t,n){return n((function(n){return Object(l.a)(n,(function(n){n[t].connectors[0].data.obj=e[0]?e[0]:void 0}))})),{}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t.connectors[0].data={},t}}]),n}(Le),nt=n(14),ot=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){var e;Object(Ie.a)(this,n),(e=t.call(this,me.ThreeJSBox,170,{x:0,y:0},{0:{name:"output",pinLayout:a.RIGHT_PIN,contentType:"node",data:{}},1:{name:"rotation_x",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},2:{name:"rotation_y",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},3:{name:"rotation_z",pinLayout:a.LEFT_PIN,contentType:"number",data:{value:0,disabled:!1}},4:{name:"color",pinLayout:a.LEFT_PIN,contentType:"none",data:{value:"rgba(255,255,255,1)"},leftPinColor:"orange"}})).cube=void 0;var o=new nt.a(1,1,1),i=new nt.c({color:16777215});return e.cube=new nt.b(o,i),e}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e){var t="1"in e?e[1]:this.connectors[1].data.value,n="2"in e?e[2]:this.connectors[2].data.value,o="3"in e?e[3]:this.connectors[3].data.value,a="4"in e?e[4]:this.connectors[4].data.value;return this.cube.material.color.setStyle(a),this.cube.rotation.set(t,n,o),{0:this.cube}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),at=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Range,170,{x:0,y:0},{0:{name:"count",pinLayout:a.BOTH_PINS,contentType:"number",data:{value:0}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e,t,n){for(var o=(Number("0"in e?e[0]:this.connectors[0].data.value)),a=[],i=0;i<o;)a.push(i),i++;return n((function(n){return Object(l.a)(n,(function(n){n[t].connectors[0].data.disabled="0"in e}))})),{0:a}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),it=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Map,150,{x:0,y:0},{0:{name:"output",pinLayout:a.RIGHT_PIN,contentType:"none",data:{}},1:{name:"input",pinLayout:a.LEFT_PIN,contentType:"none",data:{}},2:{name:"f",pinLayout:a.LEFT_PIN,contentType:"string",data:{value:""}}})}return Object(Ne.a)(n,[{key:"registerfunctionRun",value:function(e,t,n,o,a,i){var r="2"in e?e[2]:this.connectors[2].data.value,c="";return Object.keys(o).forEach((function(e){var t=o[e];t.name===me.FunctionInputNode&&t.connectors[0].data.value===r&&(c=e)})),"1"in e&&""!==c&&(e[1].forEach((function(e,t){var n={};n[3]=e,n[4]=t,i.propateFunction(c,a,n)})),!0)}},{key:"computeSpecific",value:function(e,t,n,o,a,i){var r="2"in e?e[2]:this.connectors[2].data.value,c="";if(Object.keys(o).forEach((function(e){var t=o[e];t.name===me.FunctionInputNode&&t.connectors[0].data.value===r&&(c=e)})),!("1"in e)||""===c)return{0:[]};var u=[];return e[1].forEach((function(e,t){u.push(i.popResult())})),{0:u}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),rt=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.TextArea,100,{x:0,y:0},{0:{name:"string",pinLayout:a.RIGHT_PIN,contentType:"text_area",data:{value:""}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(){return{0:this.connectors[0].data.value}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),ct=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Shift,170,{x:0,y:0},{0:{name:"array",pinLayout:a.BOTH_PINS,contentType:"none",data:{}},1:{name:"element",pinLayout:a.RIGHT_PIN,contentType:"none",data:{}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e){var t="0"in e?e[0]:[],n=t?t.length:0,o=void 0;return{0:Object(l.a)(t,(function(e){n>0&&(o=e.shift())})),1:o}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),ut=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Pop,170,{x:0,y:0},{0:{name:"array",pinLayout:a.BOTH_PINS,contentType:"none",data:{}},1:{name:"element",pinLayout:a.RIGHT_PIN,contentType:"none",data:{}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e){var t="0"in e?e[0]:[],n=t?t.length:0,o=void 0;return{0:Object(l.a)(t,(function(e){n>0&&(o=e.pop())})),1:o}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),st=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){return Object(Ie.a)(this,n),t.call(this,me.Length,170,{x:0,y:0},{0:{name:"size",pinLayout:a.RIGHT_PIN,contentType:"number",data:{value:"0",disabled:!0}},1:{name:"array",pinLayout:a.LEFT_PIN,contentType:"none",data:{}}})}return Object(Ne.a)(n,[{key:"computeSpecific",value:function(e,t,n){var o="1"in e?e[1]:[],a=o?o.length:0;return n((function(e){return Object(l.a)(e,(function(e){e[t].connectors[0].data.disabled=!0,e[t].connectors[0].data.value=a}))})),{0:a}}}],[{key:"createFromJson",value:function(e){var t=new n;return Le.initFromJson(e,t),t}}]),n}(Le),lt=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){var e;return Object(Ie.a)(this,n),(e=t.call(this,me.ObjectCreatorNode,150,{x:0,y:0},{0:{name:"object",pinLayout:a.RIGHT_PIN,contentType:"none",data:{}},1:{name:"add",pinLayout:a.NO_PINS,contentType:"button",data:{label:"add input"}},2:{name:"remove",pinLayout:a.NO_PINS,contentType:"button",data:{label:"remove input"}}})).nodeId=void 0,e.setNodes=void 0,e.add=e.add.bind(Object(Xe.a)(e)),e.remove=e.remove.bind(Object(Xe.a)(e)),e.connectors[1].data.onClick=e.add,e.connectors[2].data.onClick=e.remove,e}return Object(Ne.a)(n,[{key:"add",value:function(e){var t=this;this.nodeId&&this.setNodes&&this.setNodes((function(n){return Object(l.a)(n,(function(n){t.nodeId&&(n[t.nodeId].connectors[Object.keys(e.connectors).length]={name:"param-".concat(Object.keys(e.connectors).length-2),pinLayout:a.LEFT_PIN,contentType:"string",data:{value:""}})}))}))}},{key:"remove",value:function(e){Object.keys(e.connectors).length}},{key:"computeSpecific",value:function(e){var t=this,n={};return Object.keys(this.connectors).forEach((function(o,a){if(!(a<=2)){var i=o in e?e[o]:void 0;n[t.connectors[o].data.value]=i}})),{0:n}}}],[{key:"createFromJson",value:function(e,t,o){var a=new n;return Le.initFromJson(e,a),a.nodeId=t,a.setNodes=o,a.connectors[1].data.onClick=a.add.bind(a),a.connectors[2].data.onClick=a.remove.bind(a),a}}]),n}(Le),dt=function(e){Object(Se.a)(n,e);var t=Object(Fe.a)(n);function n(){var e;return Object(Ie.a)(this,n),(e=t.call(this,me.ObjectExtractorNode,150,{x:0,y:0},{0:{name:"object",pinLayout:a.LEFT_PIN,contentType:"none",data:{}},1:{name:"add",pinLayout:a.NO_PINS,contentType:"button",data:{label:"add input"}},2:{name:"remove",pinLayout:a.NO_PINS,contentType:"button",data:{label:"remove input"}}})).nodeId=void 0,e.setNodes=void 0,e.add=e.add.bind(Object(Xe.a)(e)),e.remove=e.remove.bind(Object(Xe.a)(e)),e.connectors[1].data.onClick=e.add,e.connectors[2].data.onClick=e.remove,e}return Object(Ne.a)(n,[{key:"add",value:function(e){var t=this;this.nodeId&&this.setNodes&&this.setNodes((function(n){return Object(l.a)(n,(function(n){t.nodeId&&(n[t.nodeId].connectors[Object.keys(e.connectors).length]={name:"param-".concat(Object.keys(e.connectors).length-2),pinLayout:a.RIGHT_PIN,contentType:"string",data:{value:""}})}))}))}},{key:"remove",value:function(e){Object.keys(e.connectors).length}},{key:"computeSpecific",value:function(e){var t=this,n={};return Object.keys(this.connectors).forEach((function(o,a){if(!(a<=2)){var i=t.connectors[o].data.value,r="0"in e&&i in e[0]?e[0][i]:void 0;n[o]=r}})),n}}],[{key:"createFromJson",value:function(e,t,o){var a=new n;return Le.initFromJson(e,a),a.nodeId=t,a.setNodes=o,a.connectors[1].data.onClick=a.add.bind(a),a.connectors[2].data.onClick=a.remove.bind(a),a}}]),n}(Le);function pt(e,t,n){var o=void 0;switch(e.name){case me.Canvas:o=Me.createFromJson(e);break;case me.Color:o=Ue.createFromJson(e);break;case me.Number:o=ze.createFromJson(e);break;case me.Rectangle:o=Re.createFromJson(e);break;case me.Rotate:o=Je.createFromJson(e);break;case me.Timer:o=He.createFromJson(e);break;case me.Translate:o=Ae.createFromJson(e);break;case me.IfElse:o=De.createFromJson(e);break;case me.String:o=Ze.createFromJson(e);break;case me.Split:o=Ge.createFromJson(e);break;case me.Operation:o=Be.createFromJson(e);break;case me.Log:o=Ve.createFromJson(e);break;case me.Arc:o=We.createFromJson(e);break;case me.Check:o=qe.createFromJson(e);break;case me.Boolean:o=Ye.createFromJson(e);break;case me.FunctionInputNode:o=Qe.createFromJson(e,t,n);break;case me.FunctionOutputNode:o=$e.createFromJson(e);break;case me.FunctionCallNode:o=Ke.createFromJson(e);break;case me.ThreeJS:o=tt.createFromJson(e);break;case me.ThreeJSBox:o=ot.createFromJson(e);break;case me.Range:o=at.createFromJson(e);break;case me.Map:o=it.createFromJson(e);break;case me.TextArea:o=rt.createFromJson(e);break;case me.Pop:o=ut.createFromJson(e);break;case me.Length:o=st.createFromJson(e);break;case me.Shift:o=ct.createFromJson(e);break;case me.ObjectCreatorNode:o=lt.createFromJson(e,t,n);break;case me.ObjectExtractorNode:o=dt.createFromJson(e,t,n);break;case me.LambdaCall:o=et.createFromJson(e,t,n)}if(!o)throw new Error("Error while reading node from json");return o}var vt=n(7),ht=function(e){var t=Object(i.useRef)(null);return Object(i.useEffect)((function(){if(t.current){var n=t.current.getContext("2d");n&&e.connector.data.canvas_draw&&e.connector.data.canvas_draw(n)}}),[t,e.connector.data]),Object(vt.jsxs)(vt.Fragment,{children:[Object(vt.jsx)("div",{style:{position:"absolute",zIndex:.1,backgroundColor:e.connector.data.canvas_color,width:e.connector.data.canvas_width,height:e.connector.data.canvas_height}}),Object(vt.jsx)("canvas",{style:{position:"relative",imageRendering:"auto"},width:e.connector.data.canvas_width,height:e.connector.data.canvas_height,ref:t})]})},ft=function(e){var t=Object(i.useRef)(null);return Object(i.useEffect)((function(){if(t.current){var n=t.current,o=new nt.f,a=new nt.d(75,window.innerWidth/window.innerHeight,.1,1e3),i=new nt.g,r=new nt.e(16711680,1,100);r.position.set(1,1,1),o.add(r),i.setSize(500,500),n.appendChild(i.domElement),a.position.z=5,e.connector.data.obj&&o.add(e.connector.data.obj);var c=0;return function e(){c=requestAnimationFrame(e),i.render(o,a)}(),function(){cancelAnimationFrame(c),n.removeChild(i.domElement),i.dispose()}}}),[t,e.connector.data]),Object(vt.jsx)("div",{style:{width:500,height:500},ref:t})};function mt(e){var t=e.connector;return"canvas"===t.contentType?Object(vt.jsx)(ht,Object(u.a)({},e)):"threejs"===t.contentType?Object(vt.jsx)(ft,Object(u.a)({},e)):null}var yt=new _e,bt=function(){var e=r.a.useState(null),t=Object(s.a)(e,2),n=t[0],o=t[1],a=r.a.useState(!1),c=Object(s.a)(a,2),d=c[0],p=c[1],v=r.a.useState({zoom:1,topLeftCorner:{x:0,y:0}}),h=Object(s.a)(v,2),m=h[0],y=h[1],b=r.a.useState([]),O=Object(s.a)(b,2),g=O[0],k=O[1],j=r.a.useState({}),P=Object(s.a)(j,2),x=P[0],I=P[1],N=r.a.useState({}),C=Object(s.a)(N,2),w=C[0],E=C[1],T=r.a.useState(!1),_=Object(s.a)(T,2),L=_[0],S=_[1];Object(i.useEffect)((function(){var e=localStorage.getItem("nodes"),t=localStorage.getItem("links"),n=e?JSON.parse(e):{},o=t?JSON.parse(t):{};e&&Object.keys(n).forEach((function(e){n[e]=pt(n[e],e,I)})),E(o),I(n),S(!0)}),[]),r.a.useEffect((function(){L&&(S(!1),yt.propagateAll(x,w),yt.runAll(x,w,I))}),[L,w,x]),Object(i.useEffect)((function(){Object.keys(x).length>0&&localStorage.setItem("nodes",JSON.stringify(x))}),[x]),Object(i.useEffect)((function(){Object.keys(w).length>0&&localStorage.setItem("links",JSON.stringify(w))}),[w]);var F={0:new Me,1:new Re,2:new Je,3:new ze,4:new He,5:new Ue,6:new Ae,7:new De,8:new Ze,9:new Ge,10:new Be,11:new Ve,12:new We,13:new qe,14:new Ye,15:new Qe,16:new $e,17:new Ke,18:new tt,19:new ot,20:new at,21:new it,22:new rt,23:new ut,24:new st,25:new ct,26:new lt,27:new dt,28:new et},M=Object(i.useCallback)((function(e){1===e.length&&"node"===e[0].type&&I((function(t){var n=e[0].id,o={};return Object.keys(t).forEach((function(e){e!==n&&(o[e]=t[e])})),o[n]=t[n],o})),k(e)}),[]);r.a.useEffect((function(){var e=setInterval((function(){var e=[],t=Object(l.c)(x,(function(t){for(var n=0,o=Object.keys(x);n<o.length;n++){var a=o[n];"timer"===t[a].name&&t[a].connectors[1].data.value&&(t[a].connectors[0].data.value=(Number(t[a].connectors[0].data.value)+1).toString(),e.push(a))}}));e.length>0&&(I(t),e.forEach((function(e){return yt.propagateNode(e,t,w)})),yt.runAll(t,w,I))}),1e3/60);return function(){return clearInterval(e)}}),[x,w]);var R=r.a.useCallback((function(e,t,n,o){I((function(a){return Object(l.c)(a,(function(a){a[e].position={x:t,y:n},a[e].width=o}))}))}),[]),J=r.a.useCallback((function(e){E((function(t){return Object(l.c)(t,(function(t){t[f()]=e}))}));var t=Object(l.c)(w,(function(t){t[f()]=e}));yt.propagateNode(e.outputNodeId,x,t),yt.runAll(x,t,I)}),[w,x]),z=r.a.useCallback((function(){var e=g.filter((function(e){return"node"===e.type})).map((function(e){return e.id})),t=g.filter((function(e){return"link"===e.type})).map((function(e){return e.id}));I((function(t){return Object(l.c)(t,(function(t){e.forEach((function(e){delete t[e]}))}))})),E((function(n){return Object(l.c)(n,(function(o){Object.keys(n).forEach((function(t){var a=n[t];(e.includes(a.inputNodeId)||e.includes(a.outputNodeId))&&delete o[t]})),t.forEach((function(e){delete o[e]}))}))}));var n=Object(l.c)(x,(function(t){e.forEach((function(e){delete t[e]}))})),o=[],a=Object(l.c)(w,(function(n){Object.keys(w).forEach((function(t){var a=w[t];(e.includes(a.inputNodeId)||e.includes(a.outputNodeId))&&(e.includes(a.outputNodeId)&&!e.includes(a.inputNodeId)&&o.push(a.inputNodeId),delete n[t])})),t.forEach((function(e){delete n[e]}))}));o.forEach((function(e){yt.propagateNode(e,n,a),yt.runAll(n,a,I)}))}),[g,x,w]),U=Object(i.useState)(void 0),H=Object(s.a)(U,2),A=H[0],D=H[1];Object(i.useEffect)((function(){A&&(yt.propagateNode(A,x,w),yt.runAll(x,w,I),D(void 0))}),[A,x,w]);var Z=r.a.useCallback((function(e){if(n){var t=f();I((function(o){return Object(l.c)(o,(function(o){var a=pt(JSON.parse(JSON.stringify(F[e])),t,I),i=-m.topLeftCorner.x/m.zoom+n.x/m.zoom,r=-m.topLeftCorner.y/m.zoom+n.y/m.zoom;a.position={x:i,y:r},o[t]=a}))})),D(t),p(!1),o(null)}}),[m,n,F]),G=r.a.useCallback((function(e,t,n){I((function(o){return Object(l.c)(o,(function(o){o[e].connectors[t]=n}))}));var o=Object(l.c)(x,(function(o){o[e].connectors[t]=n}));yt.propagateNode(e,o,w),yt.runAll(o,w,I)}),[x,w]),B=r.a.useCallback((function(e){e.preventDefault(),n?(p(!1),o(null)):o({x:e.pageX,y:e.pageY})}),[n]),V=r.a.useCallback((function(){n&&!d&&(p(!1),o(null))}),[d,n,o]),W=Object(i.useCallback)((function(){var e={nodes:x,links:w},t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(e))),t.setAttribute("download","oura-node-editor.json"),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}),[x,w]),q=Object(i.useCallback)((function(e){if(yt.reset(),!(e.target.files.size<1)){var t=new FileReader;t.onload=function(e){if(e.target&&e.target.result&&e.target.result){var t=JSON.parse(atob(e.target.result.substring(29)));Object.keys(t.nodes).forEach((function(e){t.nodes[e]=pt(t.nodes[e],e,I)})),I(t.nodes),E(t.links),S(!0)}},t.readAsDataURL(e.target.files[0])}}),[]),Y=Object(i.useCallback)((function(){yt.reset(),I({}),E({})}),[]),X=null;n&&0===g.length?X=Object(vt.jsx)("div",{style:{width:640,height:500,position:"absolute",top:n.y,left:n.x,backgroundColor:"white"},children:Object(vt.jsx)(Pe,{nodesSchema:F,onNodeSelection:Z,onMouseHover:p,createCustomConnectorComponent:mt})}):n&&(X=Object(vt.jsx)("div",{style:{width:640,height:480,position:"absolute",top:n.y,left:n.x,backgroundColor:"white"},children:Object(vt.jsx)(xe,{onMouseHover:p,onDeleteSelection:z})}));var K={font:"bold 11px Arial",textDecoration:"none",backgroundColor:"#EEEEEE",color:"#333333",padding:"2px 6px 2px 6px",borderTop:"1px solid #CCCCCC",borderRight:"1px solid #333333",borderBottom:"1px solid #333333",borderLeft:"1px solid #CCCCCC"};return Object(vt.jsxs)(vt.Fragment,{children:[Object(vt.jsxs)("div",{style:{width:"100%",height:"100%"},onContextMenu:B,onMouseDown:V,tabIndex:0,children:[Object(vt.jsx)(ye,{panZoomInfo:m,nodes:x,links:w,selectedItems:g,onPanZoomInfo:y,onSelectedItems:M,onNodeMove:R,onCreateLink:J,onConnectorUpdate:G,createCustomConnectorComponent:mt}),X]}),Object(vt.jsx)("button",{onClick:W,style:Object(u.a)({position:"absolute",left:5,bottom:5},K),children:"save"}),Object(vt.jsx)("label",{htmlFor:"files",className:"btn",style:Object(u.a)({position:"absolute",left:55,bottom:5},K),children:"load"}),Object(vt.jsx)("input",{onChange:q,id:"files",style:{visibility:"hidden"},type:"file"}),Object(vt.jsx)("button",{onClick:Y,style:Object(u.a)({position:"absolute",right:5,bottom:5},K),children:"reset"})]})},Ot=function(){return Object(vt.jsx)("div",{style:{width:"100%",height:"100vh"},className:"App",children:Object(vt.jsx)(bt,{})})},gt=document.getElementById("root");Object(c.createRoot)(gt).render(Object(vt.jsx)(r.a.StrictMode,{children:Object(vt.jsx)(Ot,{})}))}},[[37,1,2]]]);
//# sourceMappingURL=main.505101d2.chunk.js.map